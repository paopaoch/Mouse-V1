#### Mouse V1 Project log file ####

Code ran on the 2024-05-20 07:43:15.669409

Device: cuda:1
OS: linux
Machine: cblgpu01
Trainer type: xNES

NES with MMD

Metadata:
Number of neurons: 10000
Number of feedforward neurons: 100
Number of Euler steps: 300
Record average step after 280 steps
Average step weighting: 0.1
Valid weight weighting: 100000.0

Max_number of xNES optimisation step: 200
Min_number of xNES optimisation step: 20
Stopping criterion step condition for xNES optimisation: 1e-07
Stopping criterion step tolerance: 2
Number of samples per optimisation step: 12
Number of trials per full simulation: 1
Alpha for important mixing: 0.10000000149011612
Learning Rates: eta_delta=1, eta_sigma=0.08, eta_B=0.08
adaptive_lr: False
beta: 0.20000000298023224
---------------------------------------------------

Initial parameters
J
tensor([-1.3471, -2.6426,  0.1794,  4.2885], device='cuda:1')
P
tensor([-0.1496, -2.5970,  4.1483,  2.9663], device='cuda:1')
w
tensor([-3.8390,  1.3756,  3.7139,  1.7362], device='cuda:1')
heter_ff
tensor(-0.4536, device='cuda:1')

Covariance Matrix
tensor([[0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.5000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.5000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.5000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.5000]], device='cuda:1')

---------------------------------------------------


ITERATION: 0
Number of samples reused: 0
Mean: tensor([-1.3471, -2.6426,  0.1794,  4.2885, -0.1496, -2.5970,  4.1483,  2.9663,
        -3.8390,  1.3756,  3.7139,  1.7362, -0.4536], device='cuda:1')
Mean loss: 2.107227087020874
MMD Mean loss: 2.107227087020874
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.05747804790735245
Min_accepted loss 0.05747804790735245
Max_accepted loss 0.05747804790735245
Rejected 11


ITERATION: 1
Number of samples reused: 9
Mean: tensor([-1.0491, -2.5717, -0.0924,  4.4072, -0.3869, -3.0465,  4.1412,  3.2089,
        -3.9721,  1.1745,  3.7266,  1.7526, -0.5456], device='cuda:1')
Mean loss: 2.0920166969299316
MMD Mean loss: 2.0920166969299316
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.0
Min_accepted loss 0.0
Max_accepted loss 0.0
Rejected 3


ITERATION: 2
Number of samples reused: 0
Mean: tensor([-0.9862, -2.6262, -0.2535,  4.7156, -0.6297, -3.4260,  4.1850,  3.3571,
        -3.8825,  0.9802,  3.7265,  1.8351, -0.4648], device='cuda:1')
Mean loss: 2.061433792114258
MMD Mean loss: 2.061433792114258
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 1.3711962699890137
Min_accepted loss 0.1315840184688568
Max_accepted loss 2.6108086109161377
Rejected 10


ITERATION: 3
Number of samples reused: 5
Mean: tensor([-0.7616, -2.6498,  0.0088,  4.3936, -0.4396, -2.9367,  3.5015,  2.7786,
        -3.6017,  0.9481,  3.1368,  1.8248, -0.8206], device='cuda:1')
Mean loss: 2.0001254081726074
MMD Mean loss: 2.0001254081726074
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 2.6108086109161377
Min_accepted loss 2.6108086109161377
Max_accepted loss 2.6108086109161377
Rejected 7


ITERATION: 4
Number of samples reused: 0
Mean: tensor([-0.7199, -2.5059,  0.2957,  4.5237, -0.6791, -2.6654,  3.4456,  2.3998,
        -3.3812,  0.5029,  2.8531,  1.9106, -0.7865], device='cuda:1')
Mean loss: 1.9944308996200562
MMD Mean loss: 1.9944308996200562
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.03546372428536415
Min_accepted loss 0.016653748229146004
Max_accepted loss 0.05427369847893715
Rejected 10


ITERATION: 5
Number of samples reused: 8
Mean: tensor([-0.8986, -2.2494,  0.2825,  5.1806, -0.9210, -2.9407,  3.2982,  2.8549,
        -3.2557,  0.4443,  2.6918,  2.0953, -0.4847], device='cuda:1')
Mean loss: 2.0301406383514404
MMD Mean loss: 2.0301406383514404
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.03546372428536415
Min_accepted loss 0.016653748229146004
Max_accepted loss 0.05427369847893715
Rejected 4


ITERATION: 6
Number of samples reused: 0
Mean: tensor([-0.8962, -2.3043,  0.3133,  5.3744, -0.9153, -2.9427,  3.0410,  3.1731,
        -3.3400,  0.4489,  2.5101,  2.0710, -0.4150], device='cuda:1')
Mean loss: 2.013115167617798
MMD Mean loss: 2.013115167617798
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.28462526202201843
Min_accepted loss 0.28462526202201843
Max_accepted loss 0.28462526202201843
Rejected 11


ITERATION: 7
Number of samples reused: 3
Mean: tensor([-1.2318, -2.2620,  0.3527,  5.4473, -1.5025, -2.5498,  3.4981,  2.8503,
        -2.6438,  0.7653,  3.0085,  1.7762, -0.4950], device='cuda:1')
Mean loss: 2.048649787902832
MMD Mean loss: 2.048649787902832
Avg loss 4328.9921875
Min loss 0.007569999899715185
Max loss 38580.56640625
Avg_accepted loss 0.276826411485672
Min_accepted loss 0.007569999899715185
Max_accepted loss 0.7556782364845276
Rejected 6


ITERATION: 8
Number of samples reused: 3
Mean: tensor([-1.2911, -1.4085,  0.6571,  5.6788, -2.1384, -1.9309,  3.9285,  2.3717,
        -2.4806,  1.2935,  2.9653,  1.5930, -0.6806], device='cuda:1')
Mean loss: 0.025901051238179207
MMD Mean loss: 0.025901051238179207
Avg loss 51.47036361694336
Min loss 0.002047391142696142
Max loss 388.23187255859375
Avg_accepted loss 0.21511982381343842
Min_accepted loss 0.002047391142696142
Max_accepted loss 1.015781283378601
Rejected 2


ITERATION: 9
Number of samples reused: 5
Mean: tensor([-1.5181, -1.0605,  0.8800,  5.7992, -1.7869, -1.4055,  3.6209,  2.6214,
        -2.7016,  1.5382,  2.7931,  0.9791, -0.7419], device='cuda:1')
Mean loss: 0.006113381590694189
MMD Mean loss: 0.006113381590694189
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.033060140907764435
Min_accepted loss 0.002047391142696142
Max_accepted loss 0.09655794501304626
Rejected 1


ITERATION: 10
Number of samples reused: 0
Mean: tensor([-1.6336, -0.8240,  0.8566,  5.6101, -1.8185, -1.6376,  3.1674,  3.2043,
        -2.8025,  2.0818,  2.5931,  0.6562, -0.4886], device='cuda:1')
Mean loss: 0.004415484145283699
MMD Mean loss: 0.004415484145283699
Avg loss 0.20165398716926575
Min loss 0.0016526897670701146
Max loss 2.031599521636963
Avg_accepted loss 0.20165395736694336
Min_accepted loss 0.0016526897670701146
Max_accepted loss 2.031599521636963
Rejected 0


ITERATION: 11
Number of samples reused: 5
Mean: tensor([-1.7302, -1.1630,  1.0978,  5.6097, -1.9681, -1.5670,  3.2783,  3.1026,
        -3.0645,  1.9928,  3.1813,  1.2708, -0.1389], device='cuda:1')
Mean loss: 0.0030990559607744217
MMD Mean loss: 0.0030990559607744217
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.021806353703141212
Min_accepted loss 0.0016526897670701146
Max_accepted loss 0.17059144377708435
Rejected 1


ITERATION: 12
Number of samples reused: 2
Mean: tensor([-1.8117, -1.1714,  0.6167,  5.4914, -1.9613, -1.6944,  3.7688,  3.0215,
        -2.9362,  1.9395,  3.5896,  1.5061, -0.2128], device='cuda:1')
Mean loss: 0.0019188838778063655
MMD Mean loss: 0.0019188838778063655
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.0113120898604393
Min_accepted loss 0.0022695977240800858
Max_accepted loss 0.050325725227594376
Rejected 1


ITERATION: 13
Number of samples reused: 2
Mean: tensor([-1.5054, -0.9006,  0.6547,  5.5948, -2.5839, -2.0007,  3.2501,  3.4142,
        -2.8545,  1.6415,  3.1387,  1.9016, -0.0561], device='cuda:1')
Mean loss: 0.0019734816160053015
MMD Mean loss: 0.0019734816160053015
Avg loss 0.00814289040863514
Min loss 0.0022695977240800858
Max loss 0.02798149175941944
Avg_accepted loss 0.00814289040863514
Min_accepted loss 0.0022695977240800858
Max_accepted loss 0.02798149175941944
Rejected 0


ITERATION: 14
Number of samples reused: 1
Mean: tensor([-1.5167, -0.9085,  0.8256,  5.6327, -2.7842, -1.8037,  3.0813,  3.5216,
        -2.6263,  1.7589,  3.1268,  1.8435, -0.0219], device='cuda:1')
Mean loss: 0.0021755415946245193
MMD Mean loss: 0.0021755415946245193
Avg loss 0.026966026052832603
Min loss 0.002186031546443701
Max loss 0.21819671988487244
Avg_accepted loss 0.026966026052832603
Min_accepted loss 0.002186031546443701
Max_accepted loss 0.21819671988487244
Rejected 0


ITERATION: 15
Number of samples reused: 2
Mean: tensor([-1.5802, -1.1574,  0.9398,  5.5427, -2.6813, -1.7076,  2.5020,  3.4364,
        -2.8483,  2.1179,  3.1813,  1.5210, -0.2277], device='cuda:1')
Mean loss: 0.0020678953733295202
MMD Mean loss: 0.0020678953733295202
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.013957830145955086
Min_accepted loss 0.002186031546443701
Max_accepted loss 0.03449174761772156
Rejected 1


ITERATION: 16
Number of samples reused: 1
Mean: tensor([-1.8928, -1.3488,  0.9923,  5.1503, -2.6630, -1.8187,  2.6914,  3.5208,
        -2.5570,  2.0549,  3.1559,  1.3237, -0.0942], device='cuda:1')
Mean loss: 0.002082796534523368
MMD Mean loss: 0.002082796534523368
Avg loss 70.93060302734375
Min loss 0.001791330287232995
Max loss 851.0112915039062
Avg_accepted loss 0.014178909361362457
Min_accepted loss 0.001791330287232995
Max_accepted loss 0.06990095973014832
Rejected 1


ITERATION: 17
Number of samples reused: 3
Mean: tensor([-1.6518, -1.1670,  1.0350,  5.2641, -3.0984, -1.6313,  2.9537,  3.7353,
        -2.4788,  1.8513,  2.8018,  1.2386, -0.1535], device='cuda:1')
Mean loss: 0.0030047614127397537
MMD Mean loss: 0.0030047614127397537
Avg loss 0.01167935412377119
Min loss 0.001791330287232995
Max loss 0.06990095973014832
Avg_accepted loss 0.011679353192448616
Min_accepted loss 0.001791330287232995
Max_accepted loss 0.06990095973014832
Rejected 0


ITERATION: 18
Number of samples reused: 2
Mean: tensor([-1.4263, -1.1816,  0.7454,  5.3469, -3.1133, -1.6483,  3.1877,  3.7465,
        -2.3715,  1.5487,  2.6659,  0.9647, -0.1547], device='cuda:1')
Mean loss: 0.0031978802289813757
MMD Mean loss: 0.0031978802289813757
Avg loss 0.010647935792803764
Min loss 0.002091498812660575
Max loss 0.023525211960077286
Avg_accepted loss 0.010647935792803764
Min_accepted loss 0.002091498812660575
Max_accepted loss 0.023525211960077286
Rejected 0


ITERATION: 19
Number of samples reused: 2
Mean: tensor([-1.1522, -1.2010,  0.7381,  5.3124, -2.9116, -1.6028,  3.0787,  3.6043,
        -2.4498,  1.2729,  2.7391,  0.8873, -0.5384], device='cuda:1')
Mean loss: 0.001998992171138525
MMD Mean loss: 0.001998992171138525
Avg loss 0.007870020344853401
Min loss 0.0015587524976581335
Max loss 0.03725740686058998
Avg_accepted loss 0.007870020344853401
Min_accepted loss 0.0015587524976581335
Max_accepted loss 0.03725740686058998
Rejected 0


ITERATION: 20
Number of samples reused: 4
Mean: tensor([-1.5741, -1.3495,  0.3729,  5.4070, -2.8485, -1.4181,  3.1267,  3.7908,
        -2.2372,  1.2915,  2.7249,  0.8795, -0.2567], device='cuda:1')
Mean loss: 0.002454848727211356
MMD Mean loss: 0.002454848727211356
Avg loss 0.008169146254658699
Min loss 0.0015587524976581335
Max loss 0.01702270098030567
Avg_accepted loss 0.008169146254658699
Min_accepted loss 0.0015587524976581335
Max_accepted loss 0.01702270098030567
Rejected 0


ITERATION: 21
Number of samples reused: 1
Mean: tensor([-1.7395, -1.3937,  0.4722,  5.5287, -2.9418, -1.6574,  3.1440,  3.9380,
        -2.0659,  1.4281,  2.6646,  0.7924, -0.2961], device='cuda:1')
Mean loss: 0.001554699381813407
MMD Mean loss: 0.001554699381813407
Avg loss 0.021661540493369102
Min loss 0.0016778424615040421
Max loss 0.1767701804637909
Avg_accepted loss 0.021661540493369102
Min_accepted loss 0.0016778424615040421
Max_accepted loss 0.1767701804637909
Rejected 0


ITERATION: 22
Number of samples reused: 4
Mean: tensor([-1.5810, -1.3202,  0.4312,  5.2885, -3.0008, -1.5508,  3.4116,  3.8098,
        -1.7375,  1.4837,  2.7730,  0.8592, -0.2229], device='cuda:1')
Mean loss: 0.0018472389783710241
MMD Mean loss: 0.0018472389783710241
Avg loss 0.0058270413428545
Min loss 0.0016778424615040421
Max loss 0.01754734106361866
Avg_accepted loss 0.0058270413428545
Min_accepted loss 0.0016778424615040421
Max_accepted loss 0.01754734106361866
Rejected 0


ITERATION: 23
Number of samples reused: 4
Mean: tensor([-1.5279, -1.5037,  0.6241,  5.2026, -2.9384, -1.6442,  3.4983,  3.9461,
        -1.6244,  1.5139,  3.0390,  0.8030, -0.1960], device='cuda:1')
Mean loss: 0.002087207278236747
MMD Mean loss: 0.002087207278236747
Avg loss 0.0071306247264146805
Min loss 0.0022293049842119217
Max loss 0.028717132285237312
Avg_accepted loss 0.0071306247264146805
Min_accepted loss 0.0022293049842119217
Max_accepted loss 0.028717132285237312
Rejected 0


ITERATION: 24
Number of samples reused: 2
Mean: tensor([-1.7775, -1.4628,  0.7447,  5.3019, -2.7753, -1.7094,  3.2611,  3.9074,
        -1.6518,  1.6427,  3.1303,  0.7955, -0.1239], device='cuda:1')
Mean loss: 0.0034284309949725866
MMD Mean loss: 0.0034284309949725866
Avg loss 0.01499590277671814
Min loss 0.002106638392433524
Max loss 0.0939616858959198
Avg_accepted loss 0.014995904639363289
Min_accepted loss 0.002106638392433524
Max_accepted loss 0.0939616858959198
Rejected 0




Early stopping 0.0023724751081317663

---------------------------------------------------


Final loss and MMD loss:
tensor(0.0018, device='cuda:1')
tensor(0.0018, device='cuda:1')
Final mean:
tensor([-1.9625, -1.3122,  0.8821,  5.4427, -2.7553, -1.7469,  3.1670,  3.7473,
        -1.7120,  1.7404,  2.8738,  0.9178, -0.1815], device='cuda:1')

Final covariance matrix:
tensor([[0.1056, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.1056, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.1056, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.1056, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.1056, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.1056, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.1056, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.1056, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.1056,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1056, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.1056, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.1056, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.1056]], device='cuda:1')

time taken: 785.1991839408875
number of iterations: 25
average time per iter: 31.4079673576355
