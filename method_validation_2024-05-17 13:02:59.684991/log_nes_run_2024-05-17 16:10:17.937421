#### Mouse V1 Project log file ####

Code ran on the 2024-05-17 16:10:17.945881

Device: cuda:1
OS: linux
Machine: cblgpu07
Trainer type: xNES

NES with JSD

Metadata:
Number of neurons: 1000
Number of feedforward neurons: 100
Number of Euler steps: 300
Record average step after 280 steps
Average step weighting: 0.1
Valid weight weighting: 100000.0

Max_number of xNES optimisation step: 200
Min_number of xNES optimisation step: 20
Stopping criterion step condition for xNES optimisation: 1e-07
Stopping criterion step tolerance: 2
Number of samples per optimisation step: 24
Number of trials per full simulation: 1
Alpha for important mixing: 0.10000000149011612
Learning Rates: eta_delta=1, eta_sigma=0.08, eta_B=0.08
adaptive_lr: False
beta: 0.20000000298023224
---------------------------------------------------

Initial parameters
J
tensor([ 0.1064, -1.7811, -3.4017,  1.9460], device='cuda:1')
P
tensor([-3.8170, -3.7872, -0.6349,  3.1091], device='cuda:1')
w
tensor([-0.3112, -2.9728, -1.7850, -3.4798], device='cuda:1')
heter_ff
tensor(0.2000, device='cuda:1')

Covariance Matrix
tensor([[0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.5000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.5000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.5000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.5000]], device='cuda:1')

---------------------------------------------------


ITERATION: 0
Number of samples reused: 0
Mean: tensor([ 0.1064, -1.7811, -3.4017,  1.9460, -3.8170, -3.7872, -0.6349,  3.1091,
        -0.3112, -2.9728, -1.7850, -3.4798,  0.2000], device='cuda:1')
Mean loss: 0.04426879808306694
MMD Mean loss: 0.04426879808306694
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.0
Min_accepted loss 0.0
Max_accepted loss 0.0
Rejected 24


ITERATION: 1
Number of samples reused: 13
Mean: tensor([-0.2347, -2.2978, -2.9135,  1.7550, -4.2504, -3.5153, -0.2487,  2.7532,
        -0.1365, -3.0167, -1.2097, -3.0771,  0.1041], device='cuda:1')
Mean loss: 0.04641241952776909
MMD Mean loss: 0.04641241952776909
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.0
Min_accepted loss 0.0
Max_accepted loss 0.0
Rejected 11


ITERATION: 2
Number of samples reused: 3
Mean: tensor([-0.2297, -2.6083, -2.6011,  1.5145, -4.7500, -3.0767,  0.2444,  2.5552,
        -0.1174, -3.0449, -0.5599, -2.6289,  0.1240], device='cuda:1')
Mean loss: 0.04683561250567436
MMD Mean loss: 0.04683561250567436
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.0
Min_accepted loss 0.0
Max_accepted loss 0.0
Rejected 21


ITERATION: 3
Number of samples reused: 4
Mean: tensor([-0.4379, -2.7250, -1.8807,  1.3391, -4.9905, -2.7640,  0.5186,  2.4771,
         0.0322, -3.1550,  0.0097, -2.4805, -0.1438], device='cuda:1')
Mean loss: 0.026755761355161667
MMD Mean loss: 0.026755761355161667
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.019399594515562057
Min_accepted loss 0.019399594515562057
Max_accepted loss 0.019399594515562057
Rejected 19


ITERATION: 4
Number of samples reused: 11
Mean: tensor([-0.8724, -2.6400, -1.1520,  1.3921, -5.3867, -2.6164,  0.7469,  2.1836,
         0.1951, -3.0919,  0.1918, -2.5460, -0.3183], device='cuda:1')
Mean loss: 0.025162409991025925
MMD Mean loss: 0.025162409991025925
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.23718056082725525
Min_accepted loss 0.01637239381670952
Max_accepted loss 0.9077224135398865
Rejected 8


ITERATION: 5
Number of samples reused: 4
Mean: tensor([-1.0610, -2.4487, -1.2776,  1.3080, -5.6640, -2.8103,  0.9283,  2.0510,
         0.3951, -2.9851,  0.2566, -2.6334, -0.4115], device='cuda:1')
Mean loss: 0.03682131692767143
MMD Mean loss: 0.03682131692767143
Avg loss 340.5151672363281
Min loss 0.01637239381670952
Max loss 2949.951904296875
Avg_accepted loss 0.3889659345149994
Min_accepted loss 0.01637239381670952
Max_accepted loss 1.7436693906784058
Rejected 10


ITERATION: 6
Number of samples reused: 9
Mean: tensor([-1.5239, -2.3548, -1.2869,  1.0916, -5.6954, -2.2252,  0.7211,  2.1242,
         0.5090, -2.7972,  0.2238, -2.2723, -0.2967], device='cuda:1')
Mean loss: 0.012723397463560104
MMD Mean loss: 0.012723397463560104
Avg loss 114.36795043945312
Min loss 0.014856409281492233
Max loss 1413.2296142578125
Avg_accepted loss 0.28240546584129333
Min_accepted loss 0.014856409281492233
Max_accepted loss 1.5358587503433228
Rejected 4


ITERATION: 7
Number of samples reused: 5
Mean: tensor([-1.5068, -2.0305, -1.6631,  1.0072, -5.4548, -2.1371,  0.8859,  2.0836,
        -0.1696, -2.7358,  0.3847, -2.1934, -0.3586], device='cuda:1')
Mean loss: 0.01581544801592827
MMD Mean loss: 0.01581544801592827
Avg loss 164.39337158203125
Min loss 0.014856409281492233
Max loss 1280.178466796875
Avg_accepted loss 0.0983491837978363
Min_accepted loss 0.014856409281492233
Max_accepted loss 0.591460645198822
Rejected 9


ITERATION: 8
Number of samples reused: 14
Mean: tensor([-1.6344, -1.8700, -1.6659,  0.8704, -5.4804, -2.1800,  0.7848,  2.1035,
        -0.2233, -2.6081,  0.5078, -2.3397, -0.2818], device='cuda:1')
Mean loss: 0.014997314661741257
MMD Mean loss: 0.014997314661741257
Avg loss 218.54246520996094
Min loss 0.018051933497190475
Max loss 1980.624755859375
Avg_accepted loss 0.07287921756505966
Min_accepted loss 0.018051933497190475
Max_accepted loss 0.1694708615541458
Rejected 3


ITERATION: 9
Number of samples reused: 4
Mean: tensor([-1.5475, -1.7768, -1.5627,  0.6818, -5.5111, -1.5530,  0.7423,  2.1663,
        -0.1749, -2.1767,  0.5897, -2.5505, -0.0531], device='cuda:1')
Mean loss: 0.015597295016050339
MMD Mean loss: 0.015597295016050339
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.10866252332925797
Min_accepted loss 0.01435227319598198
Max_accepted loss 0.7239601016044617
Rejected 1


ITERATION: 10
Number of samples reused: 5
Mean: tensor([-1.3419, -1.7394, -1.7754,  0.4117, -5.5414, -1.6551,  0.6219,  2.0456,
        -0.2677, -2.0217,  0.8816, -2.4574, -0.0681], device='cuda:1')
Mean loss: 0.020981740206480026
MMD Mean loss: 0.020981740206480026
Avg loss 0.03558960184454918
Min loss 0.01391608640551567
Max loss 0.2354505956172943
Avg_accepted loss 0.03558960556983948
Min_accepted loss 0.01391608640551567
Max_accepted loss 0.2354505956172943
Rejected 0


ITERATION: 11
Number of samples reused: 7
Mean: tensor([-1.1862, -1.7435, -1.7115,  0.3181, -5.4702, -1.6776,  0.6386,  1.6829,
        -0.1614, -2.0736,  0.9170, -2.5542,  0.1456], device='cuda:1')
Mean loss: 0.015158962458372116
MMD Mean loss: 0.015158962458372116
Avg loss 0.0333886556327343
Min loss 0.013789724558591843
Max loss 0.1538981944322586
Avg_accepted loss 0.033388651907444
Min_accepted loss 0.013789724558591843
Max_accepted loss 0.1538981944322586
Rejected 0


ITERATION: 12
Number of samples reused: 11
Mean: tensor([-1.1800, -1.7243, -1.7551,  0.3051, -5.5047, -1.6865,  0.9087,  1.4905,
        -0.0965, -2.2476,  0.8378, -2.4317, -0.0412], device='cuda:1')
Mean loss: 0.015830110758543015
MMD Mean loss: 0.015830110758543015
Avg loss 0.03322941064834595
Min loss 0.013462971895933151
Max loss 0.16655702888965607
Avg_accepted loss 0.03322941064834595
Min_accepted loss 0.013462971895933151
Max_accepted loss 0.16655702888965607
Rejected 0


ITERATION: 13
Number of samples reused: 12
Mean: tensor([-1.1076, -1.8877, -1.8060,  0.3858, -5.6536, -1.7231,  1.0863,  1.3372,
         0.0294, -2.1145,  0.8425, -2.3827, -0.1911], device='cuda:1')
Mean loss: 0.01442248746752739
MMD Mean loss: 0.01442248746752739
Avg loss 0.05370035395026207
Min loss 0.013462971895933151
Max loss 0.40549272298812866
Avg_accepted loss 0.05370035395026207
Min_accepted loss 0.013462971895933151
Max_accepted loss 0.40549272298812866
Rejected 0


ITERATION: 14
Number of samples reused: 4
Mean: tensor([-0.9257, -2.1024, -1.8917,  0.5420, -5.8383, -1.6998,  0.9801,  1.1123,
         0.1104, -2.2335,  0.8612, -2.4213, -0.2094], device='cuda:1')
Mean loss: 0.015112590044736862
MMD Mean loss: 0.015112590044736862
Avg loss 33.8183479309082
Min loss 0.013292502611875534
Max loss 810.279296875
Avg_accepted loss 0.05917384847998619
Min_accepted loss 0.013292502611875534
Max_accepted loss 0.23513837158679962
Rejected 1


ITERATION: 15
Number of samples reused: 10
Mean: tensor([-0.9698, -2.2341, -1.9519,  0.5438, -5.7287, -1.6301,  0.7818,  0.9510,
        -0.1703, -2.1890,  1.1954, -2.5717, -0.2064], device='cuda:1')
Mean loss: 0.01454932615160942
MMD Mean loss: 0.01454932615160942
Avg loss 159.23977661132812
Min loss 0.013292502611875534
Max loss 2904.019775390625
Avg_accepted loss 0.029005149379372597
Min_accepted loss 0.013292502611875534
Max_accepted loss 0.10091287642717361
Rejected 2


ITERATION: 16
Number of samples reused: 3
Mean: tensor([-1.0251, -2.2841, -1.9591,  0.4075, -5.7880, -1.6149,  0.8222,  0.9509,
        -0.2097, -2.1924,  1.3313, -2.6396, -0.1990], device='cuda:1')
Mean loss: 0.013679098337888718
MMD Mean loss: 0.013679098337888718
Avg loss 41.59953689575195
Min loss 0.01306898519396782
Max loss 693.3079833984375
Avg_accepted loss 0.04329073801636696
Min_accepted loss 0.01306898519396782
Max_accepted loss 0.19313283264636993
Rejected 2


ITERATION: 17
Number of samples reused: 8
Mean: tensor([-1.1576, -2.3084, -1.7766,  0.3772, -5.9468, -1.6776,  0.9971,  0.8272,
        -0.2647, -2.3763,  1.4690, -2.3051, -0.1532], device='cuda:1')
Mean loss: 0.013848017901182175
MMD Mean loss: 0.013848017901182175
Avg loss 28.966747283935547
Min loss 0.01306898519396782
Max loss 693.3079833984375
Avg_accepted loss 0.0823482871055603
Min_accepted loss 0.01306898519396782
Max_accepted loss 0.6296184659004211
Rejected 0


ITERATION: 18
Number of samples reused: 3
Mean: tensor([-1.2140, -2.3131, -1.9168,  0.4649, -6.0483, -1.5851,  1.0960,  0.8816,
        -0.3759, -2.6160,  1.5220, -2.1821, -0.1054], device='cuda:1')
Mean loss: 0.017439555376768112
MMD Mean loss: 0.017439555376768112
Avg loss 21.86695671081543
Min loss 0.012905549257993698
Max loss 524.0360107421875
Avg_accepted loss 0.03351885452866554
Min_accepted loss 0.012905549257993698
Max_accepted loss 0.09299606829881668
Rejected 1


ITERATION: 19
Number of samples reused: 10
Mean: tensor([-1.3131, -2.4062, -1.9306,  0.4079, -6.4043, -1.7381,  1.0304,  0.9122,
        -0.2598, -2.5919,  1.7393, -2.2095, -0.1081], device='cuda:1')
Mean loss: 0.016939710825681686
MMD Mean loss: 0.016939710825681686
Avg loss 0.02319357357919216
Min loss 0.012905549257993698
Max loss 0.04958779737353325
Avg_accepted loss 0.02319357357919216
Min_accepted loss 0.012905549257993698
Max_accepted loss 0.04958779737353325
Rejected 0


ITERATION: 20
Number of samples reused: 5
Mean: tensor([-1.2204e+00, -2.4805e+00, -1.8089e+00,  3.1145e-01, -6.4693e+00,
        -1.7761e+00,  1.2159e+00,  9.8555e-01,  3.4743e-03, -2.6253e+00,
         1.8139e+00, -2.2878e+00, -1.6987e-01], device='cuda:1')
Mean loss: 0.013340543955564499
MMD Mean loss: 0.013340543955564499
Avg loss 0.026447629556059837
Min loss 0.012857388705015182
Max loss 0.15148015320301056
Avg_accepted loss 0.026447631418704987
Min_accepted loss 0.012857388705015182
Max_accepted loss 0.15148015320301056
Rejected 0


ITERATION: 21
Number of samples reused: 7
Mean: tensor([-1.2172, -2.2909, -1.8911,  0.2697, -6.3779, -1.8577,  1.3278,  0.9763,
         0.0794, -2.5864,  1.5784, -2.2164, -0.0173], device='cuda:1')
Mean loss: 0.015424203127622604
MMD Mean loss: 0.015424203127622604
Avg loss 4.5449419021606445
Min loss 0.012857388705015182
Max loss 108.47901153564453
Avg_accepted loss 0.02606961876153946
Min_accepted loss 0.012857388705015182
Max_accepted loss 0.07761532813310623
Rejected 1


ITERATION: 22
Number of samples reused: 2
Mean: tensor([-1.0359e+00, -2.1232e+00, -1.9060e+00,  2.2907e-01, -6.4788e+00,
        -1.9177e+00,  1.3309e+00,  9.8304e-01,  3.5375e-02, -2.5256e+00,
         1.3899e+00, -2.1739e+00, -5.6335e-03], device='cuda:1')
Mean loss: 0.016055654734373093
MMD Mean loss: 0.016055654734373093
Avg loss 0.01714513823390007
Min loss 0.01344437524676323
Max loss 0.03725464269518852
Avg_accepted loss 0.01714513823390007
Min_accepted loss 0.01344437524676323
Max_accepted loss 0.03725464269518852
Rejected 0


ITERATION: 23
Number of samples reused: 7
Mean: tensor([-0.9200, -2.0337, -1.8157,  0.2707, -6.4918, -1.7968,  1.2701,  1.1324,
        -0.0274, -2.5474,  1.3695, -2.1182,  0.0985], device='cuda:1')
Mean loss: 0.0160185806453228
MMD Mean loss: 0.0160185806453228
Avg loss 0.018621178343892097
Min loss 0.013111542910337448
Max loss 0.037983011454343796
Avg_accepted loss 0.018621178343892097
Min_accepted loss 0.013111542910337448
Max_accepted loss 0.037983011454343796
Rejected 0




Early stopping 0.015240728855133057

---------------------------------------------------


Final loss and MMD loss:
tensor(0.0150, device='cuda:1')
tensor(0.0150, device='cuda:1')
Final mean:
tensor([-0.8723, -1.9923, -1.7584,  0.1794, -6.5582, -1.7160,  1.3682,  1.0965,
        -0.1539, -2.5987,  1.3395, -2.0522,  0.0462], device='cuda:1')

Final covariance matrix:
tensor([[0.0516, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0516, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0516, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0516, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0516, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0516, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0516, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0516, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0516,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0516, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0516, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0516, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0516]], device='cuda:1')

time taken: 961.6261484622955
number of iterations: 24
average time per iter: 40.06775618592898
