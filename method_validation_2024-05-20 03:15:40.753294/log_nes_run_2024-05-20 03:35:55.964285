#### Mouse V1 Project log file ####

Code ran on the 2024-05-20 03:35:55.967386

Device: cuda:1
OS: linux
Machine: cblgpu08
Trainer type: xNES

NES with MMD

Metadata:
Number of neurons: 10000
Number of feedforward neurons: 100
Number of Euler steps: 300
Record average step after 280 steps
Average step weighting: 0.1
Valid weight weighting: 100000.0

Max_number of xNES optimisation step: 200
Min_number of xNES optimisation step: 20
Stopping criterion step condition for xNES optimisation: 1e-07
Stopping criterion step tolerance: 2
Number of samples per optimisation step: 12
Number of trials per full simulation: 1
Alpha for important mixing: 0.10000000149011612
Learning Rates: eta_delta=1, eta_sigma=0.08, eta_B=0.08
adaptive_lr: False
beta: 0.20000000298023224
---------------------------------------------------

Initial parameters
J
tensor([-3.5981,  3.4266,  0.1864,  2.8036], device='cuda:1')
P
tensor([ 2.3188,  1.4101, -1.9075,  3.8115], device='cuda:1')
w
tensor([-3.3167, -0.6157,  4.3029,  0.5276], device='cuda:1')
heter_ff
tensor(2.9263, device='cuda:1')

Covariance Matrix
tensor([[0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.5000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.5000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.5000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.5000]], device='cuda:1')

---------------------------------------------------


ITERATION: 0
Number of samples reused: 0
Mean: tensor([-3.5981,  3.4266,  0.1864,  2.8036,  2.3188,  1.4101, -1.9075,  3.8115,
        -3.3167, -0.6157,  4.3029,  0.5276,  2.9263], device='cuda:1')
Mean loss: 0.05132661759853363
MMD Mean loss: 0.05132661759853363
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.05130111053586006
Min_accepted loss 0.04640256240963936
Max_accepted loss 0.05432889983057976
Rejected 3


ITERATION: 1
Number of samples reused: 2
Mean: tensor([-3.1232,  3.3222,  0.0346,  3.3185,  2.4503,  1.0686, -2.1227,  3.6085,
        -3.2199, -0.8977,  4.3622,  0.1473,  2.9904], device='cuda:1')
Mean loss: 0.047964200377464294
MMD Mean loss: 0.047964200377464294
Avg loss 0.04706538841128349
Min loss 0.03841029107570648
Max loss 0.05147611349821091
Avg_accepted loss 0.04706538841128349
Min_accepted loss 0.03841029107570648
Max_accepted loss 0.05147611349821091
Rejected 0


ITERATION: 2
Number of samples reused: 8
Mean: tensor([-2.8572,  3.3095,  0.3013,  2.9304,  2.5658,  0.5200, -2.0139,  3.5920,
        -3.4266, -1.1247,  4.3105, -0.2583,  2.7996], device='cuda:1')
Mean loss: 0.043823231011629105
MMD Mean loss: 0.043823231011629105
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.04565386846661568
Min_accepted loss 0.03841029107570648
Max_accepted loss 0.05147611349821091
Rejected 1


ITERATION: 3
Number of samples reused: 2
Mean: tensor([-2.8089,  3.4620,  0.7914,  2.4707,  2.5375,  0.0621, -2.3867,  3.6619,
        -3.2939, -1.0858,  4.2239, -0.5488,  2.6225], device='cuda:1')
Mean loss: 0.03872142732143402
MMD Mean loss: 0.03872142732143402
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.042830973863601685
Min_accepted loss 0.03280899301171303
Max_accepted loss 0.04860006272792816
Rejected 2


ITERATION: 4
Number of samples reused: 2
Mean: tensor([-2.4499,  3.4602,  0.9194,  2.2997,  2.7260, -0.2831, -2.3732,  3.9656,
        -2.7519, -1.0598,  4.1196, -0.3184,  2.8908], device='cuda:1')
Mean loss: 1.7116734981536865
MMD Mean loss: 1.7116734981536865
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.5896998643875122
Min_accepted loss 0.03280899301171303
Max_accepted loss 1.9842288494110107
Rejected 3


ITERATION: 5
Number of samples reused: 1
Mean: tensor([-3.1186,  3.5667,  1.3444,  2.6561,  2.5530, -0.6910, -1.9595,  4.3905,
        -2.3649, -1.1192,  4.1286, -0.4810,  2.8012], device='cuda:1')
Mean loss: 0.028593039140105247
MMD Mean loss: 0.028593039140105247
Avg loss 0.052163541316986084
Min loss 0.013125516474246979
Max loss 0.21849891543388367
Avg_accepted loss 0.052163537591695786
Min_accepted loss 0.013125516474246979
Max_accepted loss 0.21849891543388367
Rejected 0


ITERATION: 6
Number of samples reused: 3
Mean: tensor([-2.8101,  3.2443,  1.8182,  2.3487,  2.5114, -0.7349, -1.8083,  4.2637,
        -2.3103, -1.4349,  3.8329, -0.8277,  2.9842], device='cuda:1')
Mean loss: 0.02671048417687416
MMD Mean loss: 0.02671048417687416
Avg loss 1667.1121826171875
Min loss 0.01142154261469841
Max loss 12833.5087890625
Avg_accepted loss 0.2651892900466919
Min_accepted loss 0.01142154261469841
Max_accepted loss 2.0218019485473633
Rejected 3


ITERATION: 7
Number of samples reused: 3
Mean: tensor([-2.8601,  3.5044,  1.8142,  2.1746,  2.2868, -0.9508, -1.2986,  4.1434,
        -2.4443, -1.1145,  3.6023, -1.2220,  3.2038], device='cuda:1')
Mean loss: 0.01719687506556511
MMD Mean loss: 0.01719687506556511
Avg loss 2247.72607421875
Min loss 0.01142154261469841
Max loss 26969.451171875
Avg_accepted loss 0.29627394676208496
Min_accepted loss 0.01142154261469841
Max_accepted loss 1.96751868724823
Rejected 1


ITERATION: 8
Number of samples reused: 2
Mean: tensor([-2.9308,  3.8299,  1.6388,  2.2071,  2.4581, -1.1109, -0.7396,  4.2222,
        -2.5193, -1.1635,  3.5828, -1.3528,  3.3724], device='cuda:1')
Mean loss: 0.014619331806898117
MMD Mean loss: 0.014619331806898117
Avg loss 51.69395446777344
Min loss 0.005301334895193577
Max loss 620.1058349609375
Avg_accepted loss 0.020143728703260422
Min_accepted loss 0.005301334895193577
Max_accepted loss 0.03306589648127556
Rejected 1


ITERATION: 9
Number of samples reused: 4
Mean: tensor([-3.0556,  4.0447,  1.3849,  1.9848,  2.1254, -1.6434, -0.8018,  4.4001,
        -2.4334, -0.7345,  3.6302, -1.4726,  2.8787], device='cuda:1')
Mean loss: 0.007770278491079807
MMD Mean loss: 0.007770278491079807
Avg loss 0.24742472171783447
Min loss 0.005301334895193577
Max loss 2.5903289318084717
Avg_accepted loss 0.24742472171783447
Min_accepted loss 0.005301334895193577
Max_accepted loss 2.5903289318084717
Rejected 0


ITERATION: 10
Number of samples reused: 2
Mean: tensor([-3.1570,  4.5002,  1.3679,  1.8858,  1.9921, -1.7158, -0.4743,  4.4756,
        -2.4808, -0.3969,  3.3828, -1.7535,  2.8164], device='cuda:1')
Mean loss: 0.010174253955483437
MMD Mean loss: 0.010174253955483437
Avg loss 9196.248046875
Min loss 0.007447464391589165
Max loss 74854.8828125
Avg_accepted loss 0.016273632645606995
Min_accepted loss 0.007447464391589165
Max_accepted loss 0.032675959169864655
Rejected 2


ITERATION: 11
Number of samples reused: 1
Mean: tensor([-3.1700,  4.3785,  1.6277,  2.0454,  1.9480, -2.0112, -0.4790,  4.7856,
        -2.4260, -0.4711,  3.4043, -1.5710,  3.0225], device='cuda:1')
Mean loss: 0.005029419902712107
MMD Mean loss: 0.005029419902712107
Avg loss 46.767173767089844
Min loss 0.004564384464174509
Max loss 561.0704345703125
Avg_accepted loss 0.01232922077178955
Min_accepted loss 0.004564384464174509
Max_accepted loss 0.032675959169864655
Rejected 1


ITERATION: 12
Number of samples reused: 3
Mean: tensor([-3.2437,  4.2853,  1.2575,  2.0925,  1.9177, -2.1039, -0.3563,  4.8213,
        -2.3946, -0.6240,  3.2030, -1.5379,  3.1227], device='cuda:1')
Mean loss: 0.004426339641213417
MMD Mean loss: 0.004426339641213417
Avg loss 0.009080041199922562
Min loss 0.004564384464174509
Max loss 0.018594834953546524
Avg_accepted loss 0.009080041199922562
Min_accepted loss 0.004564384464174509
Max_accepted loss 0.018594834953546524
Rejected 0


ITERATION: 13
Number of samples reused: 1
Mean: tensor([-3.2858,  4.2290,  1.1601,  2.1301,  1.8723, -2.2689, -0.2521,  4.8921,
        -2.5141, -0.6725,  3.3108, -1.6942,  2.9251], device='cuda:1')
Mean loss: 0.006370045244693756
MMD Mean loss: 0.006370045244693756
Avg loss 0.06829670816659927
Min loss 0.004809952341020107
Max loss 0.7425316572189331
Avg_accepted loss 0.06829670071601868
Min_accepted loss 0.004809952341020107
Max_accepted loss 0.7425316572189331
Rejected 0


ITERATION: 14
Number of samples reused: 3
Mean: tensor([-3.3491,  4.2820,  1.1192,  2.4330,  1.8788, -2.2111, -0.3642,  4.8287,
        -2.5293, -0.6449,  3.3599, -1.7160,  2.8579], device='cuda:1')
Mean loss: 0.0050687589682638645
MMD Mean loss: 0.0050687589682638645
Avg loss 0.011997519060969353
Min loss 0.004429556895047426
Max loss 0.02449677139520645
Avg_accepted loss 0.011997519060969353
Min_accepted loss 0.004429556895047426
Max_accepted loss 0.02449677139520645
Rejected 0


ITERATION: 15
Number of samples reused: 1
Mean: tensor([-3.6194,  4.1401,  1.1051,  2.4303,  1.8107, -2.2118, -0.3629,  4.7746,
        -2.4820, -0.8045,  3.3382, -1.5893,  2.9472], device='cuda:1')
Mean loss: 0.004230357240885496
MMD Mean loss: 0.004230357240885496
Avg loss 0.007891295477747917
Min loss 0.004429556895047426
Max loss 0.025204753503203392
Avg_accepted loss 0.007891295477747917
Min_accepted loss 0.004429556895047426
Max_accepted loss 0.025204753503203392
Rejected 0


ITERATION: 16
Number of samples reused: 3
Mean: tensor([-3.5546,  4.1752,  0.9643,  2.6283,  1.8142, -2.2047, -0.2452,  4.6083,
        -2.6867, -0.8731,  3.0360, -1.4393,  2.9452], device='cuda:1')
Mean loss: 0.004625178873538971
MMD Mean loss: 0.004625178873538971
Avg loss 0.009861934930086136
Min loss 0.004161694087088108
Max loss 0.049924589693546295
Avg_accepted loss 0.009861933998763561
Min_accepted loss 0.004161694087088108
Max_accepted loss 0.049924589693546295
Rejected 0


ITERATION: 17
Number of samples reused: 5
Mean: tensor([-3.7942,  4.1169,  0.9518,  2.6216,  1.8966, -2.2379, -0.1889,  4.6898,
        -2.6756, -0.7733,  2.8832, -1.4431,  2.8277], device='cuda:1')
Mean loss: 0.0043514748103916645
MMD Mean loss: 0.0043514748103916645
Avg loss 0.0060224514454603195
Min loss 0.004045940935611725
Max loss 0.01194856222718954
Avg_accepted loss 0.0060224514454603195
Min_accepted loss 0.004045940935611725
Max_accepted loss 0.01194856222718954
Rejected 0


ITERATION: 18
Number of samples reused: 3
Mean: tensor([-3.7231,  4.1339,  1.2197,  2.5207,  1.9576, -2.2429, -0.2578,  4.8384,
        -2.7798, -0.8372,  2.8073, -1.4794,  2.8647], device='cuda:1')
Mean loss: 0.0039700050838291645
MMD Mean loss: 0.0039700050838291645
Avg loss 0.0089625995606184
Min loss 0.004045940935611725
Max loss 0.032169561833143234
Avg_accepted loss 0.0089625995606184
Min_accepted loss 0.004045940935611725
Max_accepted loss 0.032169561833143234
Rejected 0


ITERATION: 19
Number of samples reused: 1
Mean: tensor([-3.6172,  4.2155,  1.2168,  2.5805,  1.8551, -2.1301, -0.1561,  4.9405,
        -2.8867, -0.8845,  2.7221, -1.3940,  2.9391], device='cuda:1')
Mean loss: 0.00389311695471406
MMD Mean loss: 0.00389311695471406
Avg loss 0.008781570941209793
Min loss 0.003543475177139044
Max loss 0.020216206088662148
Avg_accepted loss 0.008781570941209793
Min_accepted loss 0.003543475177139044
Max_accepted loss 0.020216206088662148
Rejected 0


ITERATION: 20
Number of samples reused: 1
Mean: tensor([-3.7242,  4.2560,  1.1447,  2.6941,  2.0298, -2.1216, -0.1838,  5.0750,
        -3.0655, -0.7795,  2.6097, -1.3208,  2.8694], device='cuda:1')
Mean loss: 0.006353478413075209
MMD Mean loss: 0.006353478413075209
Avg loss 0.005617319606244564
Min loss 0.003543475177139044
Max loss 0.009119490161538124
Avg_accepted loss 0.005617319606244564
Min_accepted loss 0.003543475177139044
Max_accepted loss 0.009119490161538124
Rejected 0


ITERATION: 21
Number of samples reused: 1
Mean: tensor([-3.6471,  4.1815,  0.9600,  2.7222,  2.1690, -2.1461, -0.1765,  5.0743,
        -3.1744, -0.8742,  2.5313, -1.3551,  2.9037], device='cuda:1')
Mean loss: 0.005900838412344456
MMD Mean loss: 0.005900838412344456
Avg loss 0.005778252612799406
Min loss 0.003763417713344097
Max loss 0.012624364346265793
Avg_accepted loss 0.005778252612799406
Min_accepted loss 0.003763417713344097
Max_accepted loss 0.012624364346265793
Rejected 0


ITERATION: 22
Number of samples reused: 2
Mean: tensor([-3.6628,  4.1274,  0.9551,  2.7272,  2.2038, -2.2013, -0.2182,  5.1572,
        -3.2455, -0.9271,  2.4509, -1.3079,  2.9320], device='cuda:1')
Mean loss: 0.0037683038972318172
MMD Mean loss: 0.0037683038972318172
Avg loss 0.004962831269949675
Min loss 0.003763417713344097
Max loss 0.00879834033548832
Avg_accepted loss 0.004962831269949675
Min_accepted loss 0.003763417713344097
Max_accepted loss 0.00879834033548832
Rejected 0


ITERATION: 23
Number of samples reused: 2
Mean: tensor([-3.5360,  4.2345,  0.9160,  2.6119,  2.2213, -2.2428, -0.2719,  5.2646,
        -3.3264, -0.9451,  2.4657, -1.2816,  2.9232], device='cuda:1')
Mean loss: 0.003948664758354425
MMD Mean loss: 0.003948664758354425
Avg loss 0.004800110124051571
Min loss 0.0037050035316497087
Max loss 0.007687903940677643
Avg_accepted loss 0.004800109192728996
Min_accepted loss 0.0037050035316497087
Max_accepted loss 0.007687903940677643
Rejected 0


ITERATION: 24
Number of samples reused: 1
Mean: tensor([-3.4692,  4.2583,  0.8914,  2.5904,  2.1419, -2.1848, -0.2090,  5.2161,
        -3.2956, -1.0386,  2.4863, -1.3940,  2.8582], device='cuda:1')
Mean loss: 0.005231717601418495
MMD Mean loss: 0.005231717601418495
Avg loss 0.00481844786554575
Min loss 0.0036623277701437473
Max loss 0.006931761279702187
Avg_accepted loss 0.004818448331207037
Min_accepted loss 0.0036623277701437473
Max_accepted loss 0.006931761279702187
Rejected 0


ITERATION: 25
Number of samples reused: 1
Mean: tensor([-3.5216,  4.2057,  0.8150,  2.5081,  2.1047, -2.1978, -0.1112,  5.2573,
        -3.3432, -1.0151,  2.4125, -1.3704,  2.8818], device='cuda:1')
Mean loss: 0.005249003414064646
MMD Mean loss: 0.005249003414064646
Avg loss 0.004944988526403904
Min loss 0.0036623277701437473
Max loss 0.006114698946475983
Avg_accepted loss 0.004944988526403904
Min_accepted loss 0.0036623277701437473
Max_accepted loss 0.006114698946475983
Rejected 0




Early stopping 0.0047291782684624195

---------------------------------------------------


Final loss and MMD loss:
tensor(0.0052, device='cuda:1')
tensor(0.0052, device='cuda:1')
Final mean:
tensor([-3.4607,  4.1653,  0.8148,  2.4657,  2.0685, -2.2164, -0.1744,  5.2720,
        -3.3588, -0.9814,  2.3733, -1.4059,  2.8311], device='cuda:1')

Final covariance matrix:
tensor([[0.0135, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0135, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0135, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0135, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0135, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0135, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0135, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0135, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0135,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0135, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0135, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0135, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0135]], device='cuda:1')

time taken: 1071.0905878543854
number of iterations: 26
average time per iter: 41.195791840553284
