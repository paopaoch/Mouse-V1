#### Mouse V1 Project log file ####

Code ran on the 2024-05-08 20:48:15.380161

Device: cuda:0
OS: linux
Machine: cblgpu06
Trainer type: xNES

NES with JSD

Metadata:
Number of neurons: 1000
Number of feedforward neurons: 100
Number of Euler steps: 300
Record average step after 280 steps
Average step weighting: 0.1
Valid weight weighting: 100000.0

Max_number of xNES optimisation step: 200
Min_number of xNES optimisation step: 20
Stopping criterion step condition for xNES optimisation: 1e-07
Stopping criterion step tolerance: 2
Number of samples per optimisation step: 24
Number of trials per full simulation: 1
Alpha for important mixing: 0.10000000149011612
Learning Rates: eta_delta=1, eta_sigma=0.08, eta_B=0.08
adaptive_lr: False
beta: 0.20000000298023224
---------------------------------------------------

Initial parameters
J
tensor([-2.3937,  3.8803, -4.0477,  1.5783], device='cuda:0')
P
tensor([-1.5856, -4.4521,  1.7593,  4.3441], device='cuda:0')
w
tensor([-0.6231, -4.0420, -3.4199,  1.5609], device='cuda:0')

Covariance Matrix
tensor([[0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.5000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.5000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.5000]], device='cuda:0')

---------------------------------------------------


ITERATION: 0
Number of samples reused: 0
Mean: tensor([-2.3937,  3.8803, -4.0477,  1.5783, -1.5856, -4.4521,  1.7593,  4.3441,
        -0.6231, -4.0420, -3.4199,  1.5609], device='cuda:0')
Mean loss: 0.04572629928588867
MMD Mean loss: 0.04572629928588867
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.0
Min_accepted loss 0.0
Max_accepted loss 0.0
Rejected 24


ITERATION: 1
Number of samples reused: 18
Mean: tensor([-2.4713,  3.9679, -4.0708,  1.6486, -1.4380, -4.6878,  1.6228,  4.5982,
        -1.1814, -3.6636, -3.3901,  1.6530], device='cuda:0')
Mean loss: 0.0407446026802063
MMD Mean loss: 0.0407446026802063
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.0
Min_accepted loss 0.0
Max_accepted loss 0.0
Rejected 6


ITERATION: 2
Number of samples reused: 1
Mean: tensor([-2.5030,  4.0087, -4.0808,  1.7699, -1.3140, -4.8828,  1.6105,  4.7240,
        -1.6205, -3.3143, -3.1090,  1.5859], device='cuda:0')
Mean loss: 0.03598076105117798
MMD Mean loss: 0.03598076105117798
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.0
Min_accepted loss 0.0
Max_accepted loss 0.0
Rejected 23


ITERATION: 3
Number of samples reused: 12
Mean: tensor([-2.7468,  4.0952, -3.7471,  1.9688, -1.6335, -5.1464,  1.7638,  4.6604,
        -1.7374, -3.2288, -3.0854,  1.3649], device='cuda:0')
Mean loss: 0.022727012634277344
MMD Mean loss: 0.022727012634277344
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.0
Min_accepted loss 0.0
Max_accepted loss 0.0
Rejected 12


ITERATION: 4
Number of samples reused: 8
Mean: tensor([-2.8587,  3.8211, -3.4250,  1.8593, -1.9003, -5.2955,  2.1244,  4.7189,
        -1.7351, -3.2891, -2.9918,  1.3488], device='cuda:0')
Mean loss: 0.026157259941101074
MMD Mean loss: 0.026157259941101074
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.061850666999816895
Min_accepted loss 0.061850666999816895
Max_accepted loss 0.061850666999816895
Rejected 15


ITERATION: 5
Number of samples reused: 9
Mean: tensor([-3.2083,  3.7711, -3.1443,  1.8270, -1.7587, -5.5010,  1.9814,  4.7030,
        -1.5040, -3.0544, -2.6772,  1.5912], device='cuda:0')
Mean loss: 0.024634122848510742
MMD Mean loss: 0.024634122848510742
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.061850666999816895
Min_accepted loss 0.061850666999816895
Max_accepted loss 0.061850666999816895
Rejected 15


ITERATION: 6
Number of samples reused: 7
Mean: tensor([-3.5206,  3.9181, -2.8788,  1.7814, -1.6995, -5.5073,  1.7874,  4.7423,
        -1.1638, -2.9428, -2.7085,  1.2773], device='cuda:0')
Mean loss: 0.027626991271972656
MMD Mean loss: 0.027626991271972656
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.0
Min_accepted loss 0.0
Max_accepted loss 0.0
Rejected 17


ITERATION: 7
Number of samples reused: 3
Mean: tensor([-4.0797,  4.1302, -2.5760,  2.0271, -2.1333, -5.1587,  1.7709,  4.9820,
        -1.5088, -2.4080, -2.1004,  1.4361], device='cuda:0')
Mean loss: 0.011040151119232178
MMD Mean loss: 0.011040151119232178
Avg loss 16882.640625
Min loss 0.034298062324523926
Max loss 91936.15625
Avg_accepted loss 0.034298062324523926
Min_accepted loss 0.034298062324523926
Max_accepted loss 0.034298062324523926
Rejected 20


ITERATION: 8
Number of samples reused: 10
Mean: tensor([-4.7402,  4.3277, -2.2036,  2.1672, -2.7645, -5.2173,  1.6333,  5.4444,
        -1.5229, -2.1997, -1.6412,  1.6241], device='cuda:0')
Mean loss: 0.009214162826538086
MMD Mean loss: 0.009214162826538086
Avg loss 1209.051025390625
Min loss 0.008885622024536133
Max loss 4464.3125
Avg_accepted loss 0.019465308636426926
Min_accepted loss 0.008885622024536133
Max_accepted loss 0.034298062324523926
Rejected 12


ITERATION: 9
Number of samples reused: 10
Mean: tensor([-5.0913,  4.2993, -1.9287,  2.0904, -3.2539, -5.0268,  2.0063,  5.5057,
        -1.9155, -2.3664, -1.5088,  1.6264], device='cuda:0')
Mean loss: 0.021070480346679688
MMD Mean loss: 0.021070480346679688
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.05366228520870209
Min_accepted loss 0.007832944393157959
Max_accepted loss 0.171362042427063
Rejected 4


ITERATION: 10
Number of samples reused: 6
Mean: tensor([-4.7499,  4.5549, -1.8622,  2.0991, -3.6409, -4.5594,  2.3136,  6.1087,
        -2.3963, -2.1835, -1.6217,  1.3251], device='cuda:0')
Mean loss: 0.02037125825881958
MMD Mean loss: 0.02037125825881958
Avg loss inf
Min loss 0.007832944393157959
Max loss inf
Avg_accepted loss 0.08452171087265015
Min_accepted loss 0.007832944393157959
Max_accepted loss 0.43978142738342285
Rejected 3


ITERATION: 11
Number of samples reused: 5
Mean: tensor([-4.5666,  4.6491, -2.3363,  2.0987, -3.6685, -4.2678,  1.6668,  6.2709,
        -2.4816, -2.1623, -1.9336,  1.0547], device='cuda:0')
Mean loss: 0.007433295249938965
MMD Mean loss: 0.007433295249938965
Avg loss 141.49227905273438
Min loss 0.008298039436340332
Max loss 2224.202392578125
Avg_accepted loss 0.023803940042853355
Min_accepted loss 0.008298039436340332
Max_accepted loss 0.072121262550354
Rejected 6


ITERATION: 12
Number of samples reused: 4
Mean: tensor([-4.9920,  4.6639, -2.2890,  2.3088, -3.6217, -3.9481,  1.9368,  6.1707,
        -2.3794, -2.5746, -2.0899,  1.3137], device='cuda:0')
Mean loss: 0.007769942283630371
MMD Mean loss: 0.007769942283630371
Avg loss nan
Min loss nan
Max loss nan
Avg_accepted loss 0.024548005312681198
Min_accepted loss 0.007144451141357422
Max_accepted loss 0.1372184157371521
Rejected 6


ITERATION: 13
Number of samples reused: 3
Mean: tensor([-5.0555,  4.6231, -2.2648,  2.1128, -3.6523, -3.6057,  2.2649,  6.0878,
        -2.6300, -2.6769, -1.8777,  1.2476], device='cuda:0')
Mean loss: 0.00739598274230957
MMD Mean loss: 0.00739598274230957
Avg loss 34.259765625
Min loss 0.006896317005157471
Max loss 507.2797546386719
Avg_accepted loss 0.037499163299798965
Min_accepted loss 0.006896317005157471
Max_accepted loss 0.41567182540893555
Rejected 3


ITERATION: 14
Number of samples reused: 5
Mean: tensor([-5.3889,  4.7120, -2.2861,  2.1697, -3.6317, -3.5056,  2.3884,  6.2276,
        -2.6628, -2.5887, -1.9940,  1.5206], device='cuda:0')
Mean loss: 0.007725775241851807
MMD Mean loss: 0.007725775241851807
Avg loss 32.217769622802734
Min loss 0.007006347179412842
Max loss 327.6798400878906
Avg_accepted loss 0.015651647001504898
Min_accepted loss 0.007006347179412842
Max_accepted loss 0.036152422428131104
Rejected 3


ITERATION: 15
Number of samples reused: 5
Mean: tensor([-5.5872,  4.6973, -2.5174,  2.3607, -3.4383, -3.5122,  2.2808,  6.0672,
        -2.6534, -2.4896, -1.8822,  1.2272], device='cuda:0')
Mean loss: 0.00857234001159668
MMD Mean loss: 0.00857234001159668
Avg loss 6.55732536315918
Min loss 0.007590651512145996
Max loss 157.08029174804688
Avg_accepted loss 0.012848877348005772
Min_accepted loss 0.007590651512145996
Max_accepted loss 0.06131124496459961
Rejected 0


ITERATION: 16
Number of samples reused: 7
Mean: tensor([-5.6419,  4.7334, -2.6755,  2.4631, -3.3793, -3.3463,  2.5060,  5.7438,
        -2.4337, -2.5456, -2.0591,  1.0987], device='cuda:0')
Mean loss: 0.007270753383636475
MMD Mean loss: 0.007270753383636475
Avg loss 26.300636291503906
Min loss 0.006744384765625
Max loss 630.87841796875
Avg_accepted loss 0.014649023301899433
Min_accepted loss 0.006744384765625
Max_accepted loss 0.048354506492614746
Rejected 1


ITERATION: 17
Number of samples reused: 4
Mean: tensor([-5.4951,  4.4960, -2.8564,  2.6640, -3.2779, -3.3164,  2.5441,  5.7783,
        -2.3144, -2.6331, -1.9653,  1.1344], device='cuda:0')
Mean loss: 0.00648188591003418
MMD Mean loss: 0.00648188591003418
Avg loss 37.201194763183594
Min loss 0.006744384765625
Max loss 630.87841796875
Avg_accepted loss 0.011360290460288525
Min_accepted loss 0.006744384765625
Max_accepted loss 0.03764992952346802
Rejected 2


ITERATION: 18
Number of samples reused: 7
Mean: tensor([-5.4538,  4.3576, -2.7790,  2.3931, -3.3492, -3.2683,  2.4104,  5.8222,
        -2.2300, -2.5941, -2.0473,  0.9814], device='cuda:0')
Mean loss: 0.007520496845245361
MMD Mean loss: 0.007520496845245361
Avg loss 103.62358856201172
Min loss 0.006940364837646484
Max loss 1931.15283203125
Avg_accepted loss 0.011578253470361233
Min_accepted loss 0.006940364837646484
Max_accepted loss 0.03904002904891968
Rejected 3


ITERATION: 19
Number of samples reused: 8
Mean: tensor([-5.5488,  4.2946, -2.6379,  2.3688, -3.2560, -3.2287,  2.3330,  5.7566,
        -2.1822, -2.4564, -2.0420,  0.9108], device='cuda:0')
Mean loss: 0.007325470447540283
MMD Mean loss: 0.007325470447540283
Avg loss 0.01372080110013485
Min loss 0.007355690002441406
Max loss 0.06377685070037842
Avg_accepted loss 0.01372080110013485
Min_accepted loss 0.007355690002441406
Max_accepted loss 0.06377685070037842
Rejected 0


ITERATION: 20
Number of samples reused: 9
Mean: tensor([-5.8303,  4.4067, -2.5344,  2.4533, -3.0285, -3.1297,  2.1743,  5.8615,
        -2.1564, -2.4998, -2.0220,  1.0182], device='cuda:0')
Mean loss: 0.007330954074859619
MMD Mean loss: 0.007330954074859619
Avg loss 11.810697555541992
Min loss 0.0069100260734558105
Max loss 283.23382568359375
Avg_accepted loss 0.00969123374670744
Min_accepted loss 0.0069100260734558105
Max_accepted loss 0.02382206916809082
Rejected 1


ITERATION: 21
Number of samples reused: 7
Mean: tensor([-5.9419,  4.1866, -2.4606,  2.4515, -2.9440, -3.1925,  2.1906,  5.8838,
        -2.0941, -2.5945, -1.9463,  1.2753], device='cuda:0')
Mean loss: 0.008582711219787598
MMD Mean loss: 0.008582711219787598
Avg loss 13.527483940124512
Min loss 0.0069100260734558105
Max loss 324.4143981933594
Avg_accepted loss 0.010661350563168526
Min_accepted loss 0.0069100260734558105
Max_accepted loss 0.023459792137145996
Rejected 1


ITERATION: 22
Number of samples reused: 8
Mean: tensor([-5.9997,  4.1159, -2.4910,  2.3259, -2.9139, -3.2604,  2.2710,  5.7619,
        -2.2757, -2.5147, -1.9831,  1.0594], device='cuda:0')
Mean loss: 0.007698416709899902
MMD Mean loss: 0.007698416709899902
Avg loss 13.52739143371582
Min loss 0.006808102130889893
Max loss 324.4143981933594
Avg_accepted loss 0.01056362222880125
Min_accepted loss 0.006808102130889893
Max_accepted loss 0.022632896900177002
Rejected 0


ITERATION: 23
Number of samples reused: 7
Mean: tensor([-6.1140,  4.1248, -2.5405,  2.5067, -2.9854, -3.3825,  2.1451,  5.5326,
        -2.4382, -2.4969, -1.8863,  0.9603], device='cuda:0')
Mean loss: 0.008356690406799316
MMD Mean loss: 0.008356690406799316
Avg loss 0.010496477596461773
Min loss 0.006808102130889893
Max loss 0.023160874843597412
Avg_accepted loss 0.010496477596461773
Min_accepted loss 0.006808102130889893
Max_accepted loss 0.023160874843597412
Rejected 0


ITERATION: 24
Number of samples reused: 11
Mean: tensor([-6.1298,  4.0172, -2.5660,  2.5629, -2.9460, -3.4633,  1.9235,  5.4818,
        -2.5597, -2.4638, -2.1082,  0.9933], device='cuda:0')
Mean loss: 0.00807499885559082
MMD Mean loss: 0.00807499885559082
Avg loss 0.876958966255188
Min loss 0.006748616695404053
Max loss 20.823394775390625
Avg_accepted loss 0.009722603484988213
Min_accepted loss 0.006748616695404053
Max_accepted loss 0.023160874843597412
Rejected 1


ITERATION: 25
Number of samples reused: 7
Mean: tensor([-5.9019,  4.1574, -2.6048,  2.5290, -2.9236, -3.7211,  1.7287,  5.4870,
        -2.6609, -2.2626, -2.0998,  1.0301], device='cuda:0')
Mean loss: 0.009426236152648926
MMD Mean loss: 0.009426236152648926
Avg loss 0.010111617855727673
Min loss 0.006748616695404053
Max loss 0.02438521385192871
Avg_accepted loss 0.010111617855727673
Min_accepted loss 0.006748616695404053
Max_accepted loss 0.02438521385192871
Rejected 0


ITERATION: 26
Number of samples reused: 4
Mean: tensor([-5.6109,  4.2112, -2.7158,  2.5364, -3.0251, -3.9532,  1.7797,  5.5049,
        -2.7583, -2.0983, -1.9909,  1.0006], device='cuda:0')
Mean loss: 0.007833719253540039
MMD Mean loss: 0.007833719253540039
Avg loss 13.87973403930664
Min loss 0.006375908851623535
Max loss 212.9325714111328
Avg_accepted loss 0.009580766782164574
Min_accepted loss 0.006375908851623535
Max_accepted loss 0.021747052669525146
Rejected 2


ITERATION: 27
Number of samples reused: 6
Mean: tensor([-5.4424,  4.1579, -2.8618,  2.4642, -2.9700, -3.8050,  1.7179,  5.3832,
        -2.8429, -1.9605, -1.8060,  1.1465], device='cuda:0')
Mean loss: 0.00787341594696045
MMD Mean loss: 0.00787341594696045
Avg loss 9.330181121826172
Min loss 0.006375908851623535
Max loss 212.9325714111328
Avg_accepted loss 0.009064552374184132
Min_accepted loss 0.006375908851623535
Max_accepted loss 0.014941573143005371
Rejected 1


ITERATION: 28
Number of samples reused: 1
Mean: tensor([-5.4825,  4.2421, -2.8146,  2.3850, -2.7492, -3.6264,  1.6650,  5.3807,
        -2.9240, -1.8833, -1.7593,  1.2021], device='cuda:0')
Mean loss: 0.008009791374206543
MMD Mean loss: 0.008009791374206543
Avg loss 0.009834377095103264
Min loss 0.007108032703399658
Max loss 0.017111480236053467
Avg_accepted loss 0.009834377095103264
Min_accepted loss 0.007108032703399658
Max_accepted loss 0.017111480236053467
Rejected 0


ITERATION: 29
Number of samples reused: 11
Mean: tensor([-5.6236,  4.2015, -2.6883,  2.3242, -2.6548, -3.6614,  1.6004,  5.3328,
        -2.9421, -1.8917, -1.6950,  1.0738], device='cuda:0')
Mean loss: 0.008152484893798828
MMD Mean loss: 0.008152484893798828
Avg loss 0.009508687071502209
Min loss 0.007243216037750244
Max loss 0.015514373779296875
Avg_accepted loss 0.009508687071502209
Min_accepted loss 0.007243216037750244
Max_accepted loss 0.015514373779296875
Rejected 0




Early stopping 0.008133942261338234

---------------------------------------------------


Final loss and MMD loss:
tensor(0.0073, device='cuda:0')
tensor(0.0073, device='cuda:0')
Final mean:
tensor([-5.6143,  4.2192, -2.7704,  2.3774, -2.6886, -3.6780,  1.6469,  5.2358,
        -3.0668, -1.6994, -1.6572,  0.9739], device='cuda:0')

Final covariance matrix:
tensor([[0.0581, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0581, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0581, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0581, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0581, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0581, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0581, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0581, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0581,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0581, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0581, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0581]], device='cuda:0')

time taken: 4309.993421554565
number of iterations: 30
average time per iter: 143.66644738515217
