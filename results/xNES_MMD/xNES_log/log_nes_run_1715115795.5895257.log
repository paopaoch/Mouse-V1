#### Mouse V1 Project log file ####

Code ran on the 2024-05-07 22:03:15.590298

Device: cuda:0
OS: linux
Machine: cblgpu06
Trainer type: xNES

NES with JSD

Metadata:
Number of neurons: 1000
Number of feedforward neurons: 100
Number of Euler steps: 300
Record average step after 280 steps
Average step weighting: 0.1
Valid weight weighting: 100000.0

Max_number of xNES optimisation step: 200
Min_number of xNES optimisation step: 20
Stopping criterion step condition for xNES optimisation: 1e-07
Stopping criterion step tolerance: 2
Number of samples per optimisation step: 24
Number of trials per full simulation: 1
Alpha for important mixing: 0.10000000149011612
Learning Rates: eta_delta=1, eta_sigma=0.08, eta_B=0.08
adaptive_lr: False
beta: 0.20000000298023224
---------------------------------------------------

Initial parameters
J
tensor([-1.7346, -2.5867, -1.3863, -3.1781], device='cuda:0')
P
tensor([-1.2657, -0.6190, -1.2657, -0.6190], device='cuda:0')
w
tensor([-1.0986, -1.0986, -1.0986, -1.0986], device='cuda:0')

Covariance Matrix
tensor([[0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.5000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.5000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.5000]], device='cuda:0')

---------------------------------------------------


ITERATION: 0
Number of samples reused: 0
Mean: tensor([-1.7346, -2.5867, -1.3863, -3.1781, -1.2657, -0.6190, -1.2657, -0.6190,
        -1.0986, -1.0986, -1.0986, -1.0986], device='cuda:0')
Mean loss: 0.029775500297546387
MMD Mean loss: 0.029775500297546387
Avg loss 322397.6875
Min loss 0.09422427415847778
Max loss 1520378.625
Avg_accepted loss 0.2286445051431656
Min_accepted loss 0.09422427415847778
Max_accepted loss 0.3110198974609375
Rejected 20


ITERATION: 1
Number of samples reused: 6
Mean: tensor([-1.4818, -3.0583, -0.6309, -3.1148, -1.7822, -0.7989, -0.9297, -0.8839,
        -1.2143, -1.5137, -0.9499, -0.4473], device='cuda:0')
Mean loss: 0.1579253077507019
MMD Mean loss: 0.1579253077507019
Avg loss 199923.84375
Min loss 0.012921810150146484
Max loss 1803482.875
Avg_accepted loss 0.20123408734798431
Min_accepted loss 0.012921810150146484
Max_accepted loss 0.40606939792633057
Rejected 15


ITERATION: 2
Number of samples reused: 1
Mean: tensor([-1.5619, -3.5366, -0.4364, -2.8238, -2.0747, -0.9323, -1.1801, -0.6387,
        -1.2841, -1.5715, -1.0558, -0.5453], device='cuda:0')
Mean loss: 0.11759781837463379
MMD Mean loss: 0.11759781837463379
Avg loss 34045.203125
Min loss 0.012921810150146484
Max loss 258444.640625
Avg_accepted loss 0.23227712512016296
Min_accepted loss 0.012921810150146484
Max_accepted loss 0.47573232650756836
Rejected 17


ITERATION: 3
Number of samples reused: 6
Mean: tensor([-1.7906, -3.5623, -0.2107, -2.6023, -2.2630, -0.6580, -1.0875, -0.3546,
        -1.4447, -1.5711, -1.1327, -0.9030], device='cuda:0')
Mean loss: 0.148978590965271
MMD Mean loss: 0.148978590965271
Avg loss 33017.10546875
Min loss 0.01235419511795044
Max loss 231921.359375
Avg_accepted loss 0.17927850782871246
Min_accepted loss 0.01235419511795044
Max_accepted loss 0.47431349754333496
Rejected 12


ITERATION: 4
Number of samples reused: 7
Mean: tensor([-1.7165e+00, -3.4448e+00, -2.7894e-01, -2.2946e+00, -2.4222e+00,
        -6.5537e-01, -7.7395e-01,  1.0888e-03, -1.4581e+00, -1.3427e+00,
        -1.0729e+00, -9.1116e-01], device='cuda:0')
Mean loss: 0.19951042532920837
MMD Mean loss: 0.19951042532920837
Avg loss 20535.869140625
Min loss 0.007628202438354492
Max loss 318976.1875
Avg_accepted loss 0.13719719648361206
Min_accepted loss 0.007628202438354492
Max_accepted loss 0.3594856858253479
Rejected 7


ITERATION: 5
Number of samples reused: 4
Mean: tensor([-1.8007, -3.3890, -0.5142, -2.2012, -2.6667, -0.3792, -1.2006,  0.1366,
        -1.4802, -1.0638, -1.1405, -1.1853], device='cuda:0')
Mean loss: 0.06089109182357788
MMD Mean loss: 0.06089109182357788
Avg loss 3754.07470703125
Min loss 0.007628202438354492
Max loss 42428.81640625
Avg_accepted loss 0.08312887698411942
Min_accepted loss 0.007628202438354492
Max_accepted loss 0.2580484449863434
Rejected 8


ITERATION: 6
Number of samples reused: 5
Mean: tensor([-1.8862, -3.4003, -0.8900, -2.4018, -2.8798, -0.1954, -1.5038,  0.2908,
        -1.4968, -1.0151, -1.3154, -1.3026], device='cuda:0')
Mean loss: 0.014120042324066162
MMD Mean loss: 0.014120042324066162
Avg loss 11244.3271484375
Min loss 0.00792241096496582
Max loss 66556.453125
Avg_accepted loss 0.029621988534927368
Min_accepted loss 0.00792241096496582
Max_accepted loss 0.10657435655593872
Rejected 8


ITERATION: 7
Number of samples reused: 4
Mean: tensor([-1.9662, -3.3262, -1.0140, -2.2522, -3.2045, -0.2058, -1.6116,  0.4094,
        -1.6532, -1.1547, -1.4600, -1.4167], device='cuda:0')
Mean loss: 0.008627712726593018
MMD Mean loss: 0.008627712726593018
Avg loss 2287.594482421875
Min loss 0.00792241096496582
Max loss 22164.845703125
Avg_accepted loss 0.019989818334579468
Min_accepted loss 0.00792241096496582
Max_accepted loss 0.06629765033721924
Rejected 6


ITERATION: 8
Number of samples reused: 2
Mean: tensor([-1.9091, -3.2742, -1.0707, -2.1464, -3.3484, -0.3899, -1.7393,  0.2463,
        -1.9237, -1.0479, -1.4981, -1.1581], device='cuda:0')
Mean loss: 0.007471621036529541
MMD Mean loss: 0.007471621036529541
Avg loss 11751.5693359375
Min loss 0.007259964942932129
Max loss 229733.515625
Avg_accepted loss 0.013888067565858364
Min_accepted loss 0.007259964942932129
Max_accepted loss 0.05883902311325073
Rejected 6


ITERATION: 9
Number of samples reused: 19
Mean: tensor([-1.8125, -3.3793, -1.0848, -2.1846, -3.3278, -0.3319, -1.8187,  0.2672,
        -1.8723, -1.1291, -1.9240, -1.0971], device='cuda:0')
Mean loss: 0.009922981262207031
MMD Mean loss: 0.009922981262207031
Avg loss 15123.9443359375
Min loss 0.007259964942932129
Max loss 229733.515625
Avg_accepted loss 0.014452499337494373
Min_accepted loss 0.007259964942932129
Max_accepted loss 0.05883902311325073
Rejected 2


ITERATION: 10
Number of samples reused: 1
Mean: tensor([-1.7837, -3.3754, -1.1285, -2.2319, -3.2979, -0.2730, -1.8564,  0.3008,
        -1.8422, -1.1807, -2.2648, -1.0227], device='cuda:0')
Mean loss: 0.011310040950775146
MMD Mean loss: 0.011310040950775146
Avg loss 22341.453125
Min loss 0.007443845272064209
Max loss 145735.125
Avg_accepted loss 0.010103179141879082
Min_accepted loss 0.007443845272064209
Max_accepted loss 0.018502652645111084
Rejected 14


ITERATION: 11
Number of samples reused: 6
Mean: tensor([-2.0062, -3.5564, -1.0565, -2.4327, -3.4331, -0.5384, -1.6458,  0.0730,
        -1.8108, -1.2874, -2.2098, -1.0477], device='cuda:0')
Mean loss: 0.00844430923461914
MMD Mean loss: 0.00844430923461914
Avg loss 9566.0830078125
Min loss 0.007443845272064209
Max loss 71358.34375
Avg_accepted loss 0.008935126475989819
Min_accepted loss 0.007443845272064209
Max_accepted loss 0.015511035919189453
Rejected 8


ITERATION: 12
Number of samples reused: 7
Mean: tensor([-2.0427, -3.5582, -0.9864, -2.5919, -3.4310, -0.5038, -1.6163, -0.1557,
        -1.9402, -1.0952, -2.2110, -1.1923], device='cuda:0')
Mean loss: 0.007429778575897217
MMD Mean loss: 0.007429778575897217
Avg loss 3392.59716796875
Min loss 0.007368683815002441
Max loss 64606.53515625
Avg_accepted loss 0.01003631018102169
Min_accepted loss 0.007368683815002441
Max_accepted loss 0.02198958396911621
Rejected 3


ITERATION: 13
Number of samples reused: 9
Mean: tensor([-2.0090, -3.8287, -0.8548, -2.5393, -3.7213, -0.4301, -1.8286, -0.0900,
        -2.0529, -1.1220, -2.1951, -1.0095], device='cuda:0')
Mean loss: 0.007684648036956787
MMD Mean loss: 0.007684648036956787
Avg loss 1505.046875
Min loss 0.006730079650878906
Max loss 14827.537109375
Avg_accepted loss 0.00940193235874176
Min_accepted loss 0.006730079650878906
Max_accepted loss 0.02225285768508911
Rejected 4


ITERATION: 14
Number of samples reused: 5
Mean: tensor([-2.0026, -4.0824, -0.9129, -2.6390, -3.6104, -0.4420, -1.8610,  0.0370,
        -2.0567, -1.0114, -1.9946, -0.6756], device='cuda:0')
Mean loss: 0.00776517391204834
MMD Mean loss: 0.00776517391204834
Avg loss 4030.2470703125
Min loss 0.006730079650878906
Max loss 53499.15625
Avg_accepted loss 0.008739471435546875
Min_accepted loss 0.006730079650878906
Max_accepted loss 0.012537240982055664
Rejected 5


ITERATION: 15
Number of samples reused: 7
Mean: tensor([-2.0301, -4.0401, -0.8409, -2.7463, -3.6757, -0.4805, -1.8807,  0.0625,
        -1.9969, -0.9968, -1.8394, -0.5954], device='cuda:0')
Mean loss: 0.007980823516845703
MMD Mean loss: 0.007980823516845703
Avg loss 341.04144287109375
Min loss 0.0066814422607421875
Max loss 5515.87353515625
Avg_accepted loss 0.009578412398695946
Min_accepted loss 0.0066814422607421875
Max_accepted loss 0.022704720497131348
Rejected 2


ITERATION: 16
Number of samples reused: 14
Mean: tensor([-2.1915, -3.9749, -0.8385, -2.9025, -3.3791, -0.4118, -1.9937, -0.0051,
        -1.9072, -1.0235, -1.8375, -0.5661], device='cuda:0')
Mean loss: 0.0070490241050720215
MMD Mean loss: 0.0070490241050720215
Avg loss 705.8350830078125
Min loss 0.006593048572540283
Max loss 14857.8525390625
Avg_accepted loss 0.010201706551015377
Min_accepted loss 0.006593048572540283
Max_accepted loss 0.04183143377304077
Rejected 1


ITERATION: 17
Number of samples reused: 6
Mean: tensor([-2.2798, -3.9341, -0.8890, -2.9958, -3.2930, -0.3835, -2.0852, -0.1066,
        -1.8440, -1.1864, -1.9088, -0.4379], device='cuda:0')
Mean loss: 0.006864488124847412
MMD Mean loss: 0.006864488124847412
Avg loss 751.5718994140625
Min loss 0.006593048572540283
Max loss 9283.150390625
Avg_accepted loss 0.009592422284185886
Min_accepted loss 0.006593048572540283
Max_accepted loss 0.02295064926147461
Rejected 3


ITERATION: 18
Number of samples reused: 6
Mean: tensor([-2.3549, -3.9407, -0.9507, -2.9282, -3.3895, -0.4522, -2.0782,  0.0079,
        -1.9009, -1.1733, -1.9296, -0.3153], device='cuda:0')
Mean loss: 0.008799314498901367
MMD Mean loss: 0.008799314498901367
Avg loss 1190.3140869140625
Min loss 0.006770908832550049
Max loss 11355.16796875
Avg_accepted loss 0.008769146166741848
Min_accepted loss 0.006770908832550049
Max_accepted loss 0.015321195125579834
Rejected 3


ITERATION: 19
Number of samples reused: 8
Mean: tensor([-2.2955, -3.9571, -0.9219, -2.9031, -3.6893, -0.5117, -2.0500,  0.0451,
        -2.0914, -1.3998, -1.9670, -0.2404], device='cuda:0')
Mean loss: 0.007741689682006836
MMD Mean loss: 0.007741689682006836
Avg loss 493.65447998046875
Min loss 0.006655752658843994
Max loss 9319.1396484375
Avg_accepted loss 0.008136793971061707
Min_accepted loss 0.006655752658843994
Max_accepted loss 0.01024329662322998
Rejected 3


ITERATION: 20
Number of samples reused: 8
Mean: tensor([-2.2088, -3.9574, -0.9942, -3.1053, -3.7606, -0.4859, -2.0929, -0.0776,
        -1.9627, -1.6012, -1.9853, -0.3295], device='cuda:0')
Mean loss: 0.007633030414581299
MMD Mean loss: 0.007633030414581299
Avg loss 1452.0491943359375
Min loss 0.006655752658843994
Max loss 32040.837890625
Avg_accepted loss 0.008336478844285011
Min_accepted loss 0.006655752658843994
Max_accepted loss 0.010593056678771973
Rejected 3


ITERATION: 21
Number of samples reused: 7
Mean: tensor([-2.1952, -4.0602, -1.0369, -3.2760, -3.8089, -0.2978, -2.1087,  0.0103,
        -1.9804, -1.7178, -1.9194, -0.3518], device='cuda:0')
Mean loss: 0.006880462169647217
MMD Mean loss: 0.006880462169647217
Avg loss 1276.50634765625
Min loss 0.006656944751739502
Max loss 22158.8125
Avg_accepted loss 0.009383746422827244
Min_accepted loss 0.006656944751739502
Max_accepted loss 0.036443471908569336
Rejected 3


ITERATION: 22
Number of samples reused: 4
Mean: tensor([-2.3070, -3.9985, -1.0642, -3.3470, -3.9220, -0.2952, -2.1974, -0.0910,
        -1.9164, -1.6932, -1.8381, -0.2724], device='cuda:0')
Mean loss: 0.007413387298583984
MMD Mean loss: 0.007413387298583984
Avg loss 0.008286419324576855
Min loss 0.0067441463470458984
Max loss 0.009910881519317627
Avg_accepted loss 0.008286419324576855
Min_accepted loss 0.0067441463470458984
Max_accepted loss 0.009910881519317627
Rejected 0


ITERATION: 23
Number of samples reused: 4
Mean: tensor([-2.2989, -4.0566, -0.9738, -3.2817, -3.9528, -0.3136, -2.2498, -0.1967,
        -1.8295, -1.7040, -1.8205, -0.2157], device='cuda:0')
Mean loss: 0.007520735263824463
MMD Mean loss: 0.007520735263824463
Avg loss 603.1819458007812
Min loss 0.006885170936584473
Max loss 14476.173828125
Avg_accepted loss 0.00837113056331873
Min_accepted loss 0.006885170936584473
Max_accepted loss 0.012447059154510498
Rejected 1


ITERATION: 24
Number of samples reused: 6
Mean: tensor([-2.2927, -3.9052, -1.0508, -3.2816, -4.0401, -0.4951, -2.3436, -0.1749,
        -1.8321, -1.6051, -1.8282, -0.1841], device='cuda:0')
Mean loss: 0.007387280464172363
MMD Mean loss: 0.007387280464172363
Avg loss 164.57952880859375
Min loss 0.006764471530914307
Max loss 3949.7099609375
Avg_accepted loss 0.008638732135295868
Min_accepted loss 0.006764471530914307
Max_accepted loss 0.022389650344848633
Rejected 1


ITERATION: 25
Number of samples reused: 4
Mean: tensor([-2.3260, -3.9292, -1.0371, -3.3170, -4.0783, -0.4579, -2.4053, -0.1851,
        -1.7755, -1.6696, -1.9061, -0.2580], device='cuda:0')
Mean loss: 0.007203400135040283
MMD Mean loss: 0.007203400135040283
Avg loss 0.00772151118144393
Min loss 0.00649714469909668
Max loss 0.010009586811065674
Avg_accepted loss 0.00772151118144393
Min_accepted loss 0.00649714469909668
Max_accepted loss 0.010009586811065674
Rejected 0


ITERATION: 26
Number of samples reused: 4
Mean: tensor([-2.3050, -3.9023, -1.1349, -3.3538, -4.0925, -0.4573, -2.3214, -0.3028,
        -1.7277, -1.7629, -1.8186, -0.2997], device='cuda:0')
Mean loss: 0.0074152350425720215
MMD Mean loss: 0.0074152350425720215
Avg loss 0.007704471703618765
Min loss 0.00649714469909668
Max loss 0.009440720081329346
Avg_accepted loss 0.007704471703618765
Min_accepted loss 0.00649714469909668
Max_accepted loss 0.009440720081329346
Rejected 0


ITERATION: 27
Number of samples reused: 1
Mean: tensor([-2.3019, -3.8919, -1.1654, -3.2831, -4.1123, -0.5095, -2.3451, -0.2637,
        -1.7597, -1.8289, -1.6801, -0.2445], device='cuda:0')
Mean loss: 0.008657872676849365
MMD Mean loss: 0.008657872676849365
Avg loss 0.007875422947108746
Min loss 0.006969571113586426
Max loss 0.010204315185546875
Avg_accepted loss 0.007875422947108746
Min_accepted loss 0.006969571113586426
Max_accepted loss 0.010204315185546875
Rejected 0




Early stopping 0.0076652406714856625

---------------------------------------------------


Final loss and MMD loss:
tensor(0.0088, device='cuda:0')
tensor(0.0088, device='cuda:0')
Final mean:
tensor([-2.2821, -3.8962, -1.0793, -3.3040, -4.1471, -0.4648, -2.3266, -0.1353,
        -1.7296, -1.8766, -1.7529, -0.1795], device='cuda:0')

Final covariance matrix:
tensor([[0.0276, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0276, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0276, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0276, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0276, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0276, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0276, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0276, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0276,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0276, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0276, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0276]], device='cuda:0')

time taken: 5131.1547610759735
number of iterations: 28
average time per iter: 183.25552718128478
