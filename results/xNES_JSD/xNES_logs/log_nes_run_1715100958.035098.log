#### Mouse V1 Project log file ####

Code ran on the 2024-05-07 17:55:58.035836

Device: cuda:0
OS: linux
Machine: cblgpu06
Trainer type: xNES

NES with JSD

Metadata:
Number of neurons: 1000
Number of feedforward neurons: 100
Number of Euler steps: 300
Record average step after 280 steps
Average step weighting: 0.1
Valid weight weighting: 100000.0

Max_number of xNES optimisation step: 200
Min_number of xNES optimisation step: 20
Stopping criterion step condition for xNES optimisation: 1e-07
Stopping criterion step tolerance: 2
Number of samples per optimisation step: 24
Number of trials per full simulation: 1
Alpha for important mixing: 0.10000000149011612
Learning Rates: eta_delta=1, eta_sigma=0.08, eta_B=0.08
adaptive_lr: False
beta: 0.20000000298023224
---------------------------------------------------

Initial parameters
J
tensor([-1.7346, -2.5867, -1.3863, -3.1781], device='cuda:0')
P
tensor([-1.2657, -0.6190, -1.2657, -0.6190], device='cuda:0')
w
tensor([-1.0986, -1.0986, -1.0986, -1.0986], device='cuda:0')

Covariance Matrix
tensor([[0.1000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.1000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.1000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.1000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.1000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.1000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.1000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.1000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.1000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.1000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.1000]], device='cuda:0')

---------------------------------------------------


ITERATION: 0
Number of samples reused: 0
Mean: tensor([-1.7346, -2.5867, -1.3863, -3.1781, -1.2657, -0.6190, -1.2657, -0.6190,
        -1.0986, -1.0986, -1.0986, -1.0986], device='cuda:0')
Mean loss: 0.016131889948549215
MMD Mean loss: 0.016131889948549215
Avg loss 111321.55981808966
Min loss 0.01009608584544028
Max loss 364451.6875
Avg_accepted loss 0.013375446590224375
Min_accepted loss 0.01009608584544028
Max_accepted loss 0.015483579296038462
Rejected 21


ITERATION: 1
Number of samples reused: 9
Mean: tensor([-1.8355, -2.6874, -1.3261, -3.0154, -1.3395, -0.6265, -1.1622, -0.3174,
        -1.1006, -1.2542, -0.9586, -1.0283], device='cuda:0')
Mean loss: 0.015894973329770808
MMD Mean loss: 0.015894973329770808
Avg loss 53491.56042061193
Min loss 0.00778174765737406
Max loss 399620.53125
Avg_accepted loss 0.01634065084792638
Min_accepted loss 0.00778174765737406
Max_accepted loss 0.03370264889365081
Rejected 12


ITERATION: 2
Number of samples reused: 1
Mean: tensor([-2.0696, -2.8804, -1.3375, -3.0293, -1.4554, -0.5307, -1.3016, -0.1167,
        -1.0529, -1.3232, -0.9752, -1.0640], device='cuda:0')
Mean loss: 0.012443232252544654
MMD Mean loss: 0.012443232252544654
Avg loss 19144.527182039572
Min loss 0.007757711798252241
Max loss 197313.125
Avg_accepted loss 0.012957409150471048
Min_accepted loss 0.007757711798252241
Max_accepted loss 0.03775397071953966
Rejected 9


ITERATION: 3
Number of samples reused: 4
Mean: tensor([-2.1559, -2.8795, -1.5099, -2.9697, -1.5617, -0.4512, -1.4219, -0.0959,
        -1.1624, -1.3518, -0.9461, -1.0212], device='cuda:0')
Mean loss: 0.00850370503149246
MMD Mean loss: 0.00850370503149246
Avg loss 26958.744413187924
Min loss 0.0075514241629301235
Max loss 119427.5859375
Avg_accepted loss 0.010546712929904561
Min_accepted loss 0.0075514241629301235
Max_accepted loss 0.01753408400351407
Rejected 14


ITERATION: 4
Number of samples reused: 3
Mean: tensor([-2.2682, -2.7895, -1.6096, -2.7765, -1.6144, -0.3698, -1.3134,  0.0110,
        -1.1382, -1.3726, -1.0191, -0.8714], device='cuda:0')
Mean loss: 0.008585132251619932
MMD Mean loss: 0.008585132251619932
Avg loss 8050.117249680088
Min loss 0.007179529096638413
Max loss 51082.359375
Avg_accepted loss 0.009418815417405389
Min_accepted loss 0.007179529096638413
Max_accepted loss 0.013792658225883271
Rejected 9


ITERATION: 5
Number of samples reused: 6
Mean: tensor([-2.3441, -2.6553, -1.6722, -2.6349, -1.6643, -0.3571, -1.3251,  0.2472,
        -1.2309, -1.4239, -0.9643, -0.7476], device='cuda:0')
Mean loss: 0.0071909373074761085
MMD Mean loss: 0.0071909373074761085
Avg loss 2748.3899911786725
Min loss 0.006586454850021188
Max loss 34598.265625
Avg_accepted loss 0.008111198244300462
Min_accepted loss 0.006586454850021188
Max_accepted loss 0.01266125748297425
Rejected 3


ITERATION: 6
Number of samples reused: 9
Mean: tensor([-2.2860, -2.6384, -1.7772, -2.6538, -1.7519, -0.3538, -1.5279,  0.2307,
        -1.2543, -1.3638, -0.9964, -0.6575], device='cuda:0')
Mean loss: 0.007102346100535032
MMD Mean loss: 0.007102346100535032
Avg loss 6971.977531731527
Min loss 0.006586454850021188
Max loss 35750.4140625
Avg_accepted loss 0.007259335519248972
Min_accepted loss 0.006586454850021188
Max_accepted loss 0.009489199371205872
Rejected 8


ITERATION: 7
Number of samples reused: 2
Mean: tensor([-2.3159, -2.5946, -1.7147, -2.6359, -1.7747, -0.2699, -1.5731,  0.1556,
        -1.2317, -1.2899, -1.0435, -0.6234], device='cuda:0')
Mean loss: 0.006311798952734574
MMD Mean loss: 0.006311798952734574
Avg loss 10692.94897310573
Min loss 0.006670211210192926
Max loss 72756.6953125
Avg_accepted loss 0.007209965060459791
Min_accepted loss 0.006670211210192926
Max_accepted loss 0.0082576962448285
Rejected 13


ITERATION: 8
Number of samples reused: 2
Mean: tensor([-2.3498, -2.5641, -1.6770, -2.6353, -1.9225, -0.2126, -1.5706,  0.1537,
        -1.3243, -1.3135, -1.0260, -0.5051], device='cuda:0')
Mean loss: 0.0066428126627370715
MMD Mean loss: 0.0066428126627370715
Avg loss 596.7423929555567
Min loss 0.006721193999042662
Max loss 14321.6494140625
Avg_accepted loss 0.007305081341951633
Min_accepted loss 0.006721193999042662
Max_accepted loss 0.0082576962448285
Rejected 1


ITERATION: 9
Number of samples reused: 11
Mean: tensor([-2.2461, -2.5963, -1.6840, -2.6731, -1.9002, -0.2686, -1.5371,  0.1437,
        -1.3176, -1.3423, -1.0432, -0.4640], device='cuda:0')
Mean loss: 0.006797643835154804
MMD Mean loss: 0.006797643835154804
Avg loss 0.007081400766954839
Min loss 0.006363733313230719
Max loss 0.008424489419900582
Avg_accepted loss 0.007081400766954839
Min_accepted loss 0.006363733313230719
Max_accepted loss 0.008424489419900582
Rejected 0


ITERATION: 10
Number of samples reused: 2
Mean: tensor([-2.2068, -2.5685, -1.6641, -2.6498, -1.9753, -0.2465, -1.6187,  0.1632,
        -1.3149, -1.3812, -1.0982, -0.4451], device='cuda:0')
Mean loss: 0.007137086325898313
MMD Mean loss: 0.007137086325898313
Avg loss 513.8401260612043
Min loss 0.006176377765712825
Max loss 8611.4853515625
Avg_accepted loss 0.006895475105259283
Min_accepted loss 0.006176377765712825
Max_accepted loss 0.007599934414487931
Rejected 4


ITERATION: 11
Number of samples reused: 5
Mean: tensor([-2.2387, -2.5501, -1.7205, -2.6517, -1.8968, -0.3101, -1.5834,  0.1404,
        -1.3937, -1.3734, -1.1006, -0.4543], device='cuda:0')
Mean loss: 0.006809653373080155
MMD Mean loss: 0.006809653373080155
Avg loss 259.13409208269303
Min loss 0.006157465407450006
Max loss 2076.91796875
Avg_accepted loss 0.007053077356681795
Min_accepted loss 0.006157465407450006
Max_accepted loss 0.007634685609276793
Rejected 4


ITERATION: 12
Number of samples reused: 3
Mean: tensor([-2.2993, -2.5910, -1.7181, -2.6292, -1.9290, -0.3548, -1.5383,  0.2069,
        -1.3948, -1.3788, -1.1169, -0.4181], device='cuda:0')
Mean loss: 0.0068842233582142535
MMD Mean loss: 0.0068842233582142535
Avg loss 219.5544332754224
Min loss 0.006391521274573124
Max loss 5269.14599609375
Avg_accepted loss 0.006974022451625119
Min_accepted loss 0.006391521274573124
Max_accepted loss 0.00769661262012184
Rejected 1


ITERATION: 13
Number of samples reused: 7
Mean: tensor([-2.3677, -2.6400, -1.7883, -2.6520, -1.9762, -0.3733, -1.5188,  0.1983,
        -1.3283, -1.3934, -1.1484, -0.3979], device='cuda:0')
Mean loss: 0.006818521326887731
MMD Mean loss: 0.006818521326887731
Avg loss 134.24950913213917
Min loss 0.006255805537830694
Max loss 3221.830810546875
Avg_accepted loss 0.006843853237613431
Min_accepted loss 0.006255805537830694
Max_accepted loss 0.007521609492073804
Rejected 1


ITERATION: 14
Number of samples reused: 10
Mean: tensor([-2.3735, -2.6184, -1.7853, -2.6755, -2.0232, -0.4188, -1.5445,  0.1815,
        -1.2860, -1.4403, -1.1480, -0.3523], device='cuda:0')
Mean loss: 0.006929657362313144
MMD Mean loss: 0.006929657362313144
Avg loss 176.83789552213761
Min loss 0.006255805537830694
Max loss 4243.9521484375
Avg_accepted loss 0.006841047556649663
Min_accepted loss 0.006255805537830694
Max_accepted loss 0.00749286832836171
Rejected 1


ITERATION: 15
Number of samples reused: 7
Mean: tensor([-2.3199, -2.5926, -1.7906, -2.6886, -2.0045, -0.4841, -1.5448,  0.1972,
        -1.3110, -1.4427, -1.1403, -0.3743], device='cuda:0')
Mean loss: 0.006460093845335628
MMD Mean loss: 0.006460093845335628
Avg loss 1087.821258582252
Min loss 0.006321872453234274
Max loss 10825.0078125
Avg_accepted loss 0.0069406118594806995
Min_accepted loss 0.006321872453234274
Max_accepted loss 0.007414082365394927
Rejected 3


ITERATION: 16
Number of samples reused: 11
Mean: tensor([-2.2634, -2.5573, -1.7912, -2.7735, -1.9673, -0.5179, -1.5274,  0.1931,
        -1.3283, -1.4135, -1.1763, -0.3840], device='cuda:0')
Mean loss: 0.006942636334917833
MMD Mean loss: 0.006942636334917833
Avg loss 1222.5518325922621
Min loss 0.006474718871374931
Max loss 10825.0078125
Avg_accepted loss 0.006974501339765085
Min_accepted loss 0.006474718871374931
Max_accepted loss 0.007634341562120823
Rejected 2


ITERATION: 17
Number of samples reused: 6
Mean: tensor([-2.2922, -2.5820, -1.7679, -2.7943, -1.9079, -0.5308, -1.5190,  0.2064,
        -1.3539, -1.3895, -1.2268, -0.3912], device='cuda:0')
Mean loss: 0.006838430115461739
MMD Mean loss: 0.006838430115461739
Avg loss 1326.1122884339293
Min loss 0.006474718871374931
Max loss 12120.7890625
Avg_accepted loss 0.006910367943080917
Min_accepted loss 0.006474718871374931
Max_accepted loss 0.0076888857037310885
Rejected 3


ITERATION: 18
Number of samples reused: 6
Mean: tensor([-2.3189, -2.5986, -1.7925, -2.7701, -1.9182, -0.5474, -1.5366,  0.2341,
        -1.3551, -1.3591, -1.2739, -0.3894], device='cuda:0')
Mean loss: 0.006830666441422606
MMD Mean loss: 0.006830666441422606
Avg loss 1452.461927022236
Min loss 0.006530973586259134
Max loss 13573.5009765625
Avg_accepted loss 0.006916555225860108
Min_accepted loss 0.006530973586259134
Max_accepted loss 0.007799539587855225
Rejected 5


ITERATION: 19
Number of samples reused: 3
Mean: tensor([-2.3247, -2.5235, -1.8377, -2.7430, -1.9626, -0.5317, -1.5393,  0.2503,
        -1.3390, -1.3587, -1.2693, -0.3887], device='cuda:0')
Mean loss: 0.006625795166333115
MMD Mean loss: 0.006625795166333115
Avg loss 1355.13552348509
Min loss 0.006568170792537926
Max loss 12686.22265625
Avg_accepted loss 0.006911512721959966
Min_accepted loss 0.006568170792537926
Max_accepted loss 0.007465538845241349
Rejected 2


ITERATION: 20
Number of samples reused: 13
Mean: tensor([-2.3670, -2.5362, -1.7733, -2.7868, -1.9426, -0.5603, -1.6016,  0.2156,
        -1.3303, -1.3562, -1.2205, -0.4291], device='cuda:0')
Mean loss: 0.006658765432958623
MMD Mean loss: 0.006658765432958623
Avg loss 1160.2008838858294
Min loss 0.006568170792537926
Max loss 11220.47265625
Avg_accepted loss 0.006902082317041086
Min_accepted loss 0.006568170792537926
Max_accepted loss 0.00746238278681079
Rejected 2


ITERATION: 21
Number of samples reused: 8
Mean: tensor([-2.4011, -2.5342, -1.7627, -2.8077, -1.8996, -0.5591, -1.6024,  0.1593,
        -1.3503, -1.3793, -1.2170, -0.4375], device='cuda:0')
Mean loss: 0.006526836641382518
MMD Mean loss: 0.006526836641382518
Avg loss 740.7299914210155
Min loss 0.006414068101128005
Max loss 9425.533203125
Avg_accepted loss 0.006906583095284474
Min_accepted loss 0.006414068101128005
Max_accepted loss 0.0073396779185720355
Rejected 2


ITERATION: 22
Number of samples reused: 8
Mean: tensor([-2.4122, -2.5008, -1.7645, -2.8388, -1.9082, -0.6195, -1.5868,  0.1747,
        -1.2899, -1.4077, -1.2210, -0.4041], device='cuda:0')
Mean loss: 0.007200781205545142
MMD Mean loss: 0.007200781205545142
Avg loss 205.0826136627041
Min loss 0.006414068101128005
Max loss 4921.82373046875
Avg_accepted loss 0.006912932006462481
Min_accepted loss 0.006414068101128005
Max_accepted loss 0.007632886421769383
Rejected 0


ITERATION: 23
Number of samples reused: 4
Mean: tensor([-2.4223, -2.4961, -1.7412, -2.8843, -1.9151, -0.6590, -1.6085,  0.2089,
        -1.2367, -1.3606, -1.2172, -0.4336], device='cuda:0')
Mean loss: 0.006462150699315555
MMD Mean loss: 0.006462150699315555
Avg loss 94.28626248102853
Min loss 0.0064999955706059286
Max loss 2262.71142578125
Avg_accepted loss 0.006907554931971714
Min_accepted loss 0.0064999955706059286
Max_accepted loss 0.007474053814116002
Rejected 1


ITERATION: 24
Number of samples reused: 7
Mean: tensor([-2.3801, -2.5135, -1.7468, -2.9028, -1.8787, -0.6798, -1.5826,  0.2342,
        -1.2324, -1.3504, -1.2061, -0.4228], device='cuda:0')
Mean loss: 0.006953918590335357
MMD Mean loss: 0.006953918590335357
Avg loss 945.1415910264388
Min loss 0.0063276129456137625
Max loss 11083.1171875
Avg_accepted loss 0.00687039926377045
Min_accepted loss 0.0063276129456137625
Max_accepted loss 0.0072848672444260016
Rejected 3


ITERATION: 25
Number of samples reused: 10
Mean: tensor([-2.3874, -2.5828, -1.7098, -2.8707, -1.8967, -0.6461, -1.6090,  0.2303,
        -1.2193, -1.3259, -1.1828, -0.4266], device='cuda:0')
Mean loss: 0.0071641467626979575
MMD Mean loss: 0.0071641467626979575
Avg loss 945.1415789927148
Min loss 0.0063276129456137625
Max loss 11083.1171875
Avg_accepted loss 0.006856646436093848
Min_accepted loss 0.0063276129456137625
Max_accepted loss 0.007298202493956342
Rejected 0


ITERATION: 26
Number of samples reused: 6
Mean: tensor([-2.4252, -2.6599, -1.6965, -2.8586, -1.8881, -0.6028, -1.6369,  0.2117,
        -1.2263, -1.2942, -1.1835, -0.4106], device='cuda:0')
Mean loss: 0.007191754038963934
MMD Mean loss: 0.007191754038963934
Avg loss 921.9851002998403
Min loss 0.006451264474023978
Max loss 8561.59375
Avg_accepted loss 0.00683015362213082
Min_accepted loss 0.006451264474023978
Max_accepted loss 0.007408264097786757
Rejected 5


ITERATION: 27
Number of samples reused: 11
Mean: tensor([-2.4467, -2.6625, -1.6732, -2.9273, -1.9016, -0.5949, -1.6037,  0.1993,
        -1.2555, -1.3104, -1.2058, -0.3586], device='cuda:0')
Mean loss: 0.006745341953824419
MMD Mean loss: 0.006745341953824419
Avg loss 114.9316834370223
Min loss 0.006451264474023978
Max loss 1792.547119140625
Avg_accepted loss 0.00692980505414417
Min_accepted loss 0.006451264474023978
Max_accepted loss 0.007408264097786757
Rejected 0


ITERATION: 28
Number of samples reused: 3
Mean: tensor([-2.4189, -2.6422, -1.6373, -2.9220, -1.9272, -0.5982, -1.6098,  0.2003,
        -1.2900, -1.3045, -1.2268, -0.3279], device='cuda:0')
Mean loss: 0.007004855113871884
MMD Mean loss: 0.007004855113871884
Avg loss 0.006807172288349418
Min loss 0.006078945864881925
Max loss 0.00719600001743044
Avg_accepted loss 0.006807172288349419
Min_accepted loss 0.006078945864881925
Max_accepted loss 0.00719600001743044
Rejected 0


ITERATION: 29
Number of samples reused: 12
Mean: tensor([-2.4414, -2.6129, -1.6639, -2.8969, -1.9348, -0.6316, -1.6365,  0.1906,
        -1.3137, -1.3638, -1.2130, -0.3368], device='cuda:0')
Mean loss: 0.007471761191240856
MMD Mean loss: 0.007471761191240856
Avg loss 0.00685057972519939
Min loss 0.006078945864881925
Max loss 0.007538381472082924
Avg_accepted loss 0.00685057972519939
Min_accepted loss 0.006078945864881925
Max_accepted loss 0.007538381472082924
Rejected 0




Early stopping 0.006938031163013625

---------------------------------------------------


Final loss and MMD loss:
tensor(0.0068, device='cuda:0', dtype=torch.float64)
tensor(0.0068, dtype=torch.float64)
Final mean:
tensor([-2.4301, -2.6042, -1.7010, -2.8844, -1.9108, -0.6370, -1.6651,  0.1786,
        -1.3112, -1.3845, -1.2137, -0.3243], device='cuda:0')

Final covariance matrix:
tensor([[0.0059, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0059, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0059, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0059, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0059, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0059, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0059, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0059, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0059,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0059, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0059, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0059]], device='cuda:0')

time taken: 6407.7525725364685
number of iterations: 30
average time per iter: 213.59175241788228
