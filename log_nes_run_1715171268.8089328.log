#### Mouse V1 Project log file ####

Code ran on the 2024-05-08 13:27:48.809610

Device: cuda:1
OS: linux
Machine: cblgpu06
Trainer type: xNES

NES with JSD

Metadata:
Number of neurons: 1000
Number of feedforward neurons: 100
Number of Euler steps: 300
Record average step after 280 steps
Average step weighting: 0.1
Valid weight weighting: 100000.0

Max_number of xNES optimisation step: 200
Min_number of xNES optimisation step: 20
Stopping criterion step condition for xNES optimisation: 1e-07
Stopping criterion step tolerance: 2
Number of samples per optimisation step: 24
Number of trials per full simulation: 1
Alpha for important mixing: 0.10000000149011612
Learning Rates: eta_delta=1, eta_sigma=0.08, eta_B=0.08
adaptive_lr: False
beta: 0.20000000298023224
---------------------------------------------------

Initial parameters
J
tensor([-2.3109, -2.8352, -1.7802, -2.2878], device='cuda:1')
P
tensor([-2.1145, -0.4038, -1.4918, -0.1283], device='cuda:1')
w
tensor([-1.4134, -1.4288, -0.9577, -0.6836], device='cuda:1')

Covariance Matrix
tensor([[0.1000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.1000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.1000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.1000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.1000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.1000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.1000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.1000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.1000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.1000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.1000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.1000]], device='cuda:1')

---------------------------------------------------


ITERATION: 0
Number of samples reused: 0
Mean: tensor([-2.3109, -2.8352, -1.7802, -2.2878, -2.1145, -0.4038, -1.4918, -0.1283,
        -1.4134, -1.4288, -0.9577, -0.6836], device='cuda:1')
Mean loss: 0.006797302817063347
MMD Mean loss: 0.006797302817063347
Avg loss 12073.377128337488
Min loss 0.006613501667208148
Max loss 106368.5390625
Avg_accepted loss 0.007310687925398304
Min_accepted loss 0.006613501667208148
Max_accepted loss 0.008605906206373085
Rejected 10


ITERATION: 1
Number of samples reused: 7
Mean: tensor([-2.2720, -2.7262, -1.7574, -2.2987, -2.1505, -0.4211, -1.5779, -0.2545,
        -1.4539, -1.3834, -0.8409, -0.6985], device='cuda:1')
Mean loss: 0.006406669078884143
MMD Mean loss: 0.006406669078884143
Avg loss 5573.907377096443
Min loss 0.006462624703962389
Max loss 58087.6484375
Avg_accepted loss 0.007335680273909528
Min_accepted loss 0.006462624703962389
Max_accepted loss 0.010041766223885185
Rejected 7


ITERATION: 2
Number of samples reused: 6
Mean: tensor([-2.2905, -2.6032, -1.9164, -2.3658, -2.1705, -0.3719, -1.5893, -0.2799,
        -1.4665, -1.5010, -0.5926, -0.7127], device='cuda:1')
Mean loss: 0.006430114979472835
MMD Mean loss: 0.006430114979472835
Avg loss 1294.4416696744402
Min loss 0.006462624703962389
Max loss 13708.056640625
Avg_accepted loss 0.007214296823228598
Min_accepted loss 0.006462624703962389
Max_accepted loss 0.009087594620819518
Rejected 5


ITERATION: 3
Number of samples reused: 3
Mean: tensor([-2.3046, -2.6145, -1.9550, -2.4185, -2.0447, -0.3119, -1.7086, -0.3197,
        -1.4780, -1.4744, -0.4648, -0.6982], device='cuda:1')
Mean loss: 0.006493166723398737
MMD Mean loss: 0.006493166723398737
Avg loss 1481.6642064262405
Min loss 0.006490940869825849
Max loss 13700.1279296875
Avg_accepted loss 0.007268906898322623
Min_accepted loss 0.006490940869825849
Max_accepted loss 0.008590806531624268
Rejected 6


ITERATION: 4
Number of samples reused: 12
Mean: tensor([-2.2861, -2.5761, -1.9613, -2.4315, -2.0272, -0.2588, -1.8386, -0.2135,
        -1.4066, -1.3787, -0.5036, -0.7869], device='cuda:1')
Mean loss: 0.007240170469387232
MMD Mean loss: 0.007240170469387232
Avg loss 4859.58152592947
Min loss 0.006490940869825849
Max loss 68835.8671875
Avg_accepted loss 0.007171991875486845
Min_accepted loss 0.006490940869825849
Max_accepted loss 0.008224553762130112
Rejected 4


ITERATION: 5
Number of samples reused: 3
Mean: tensor([-2.3163, -2.4659, -1.8851, -2.3536, -2.0168, -0.2885, -1.8651, -0.2459,
        -1.3700, -1.3503, -0.5261, -0.8152], device='cuda:1')
Mean loss: 0.007210633103763731
MMD Mean loss: 0.007210633103763731
Avg loss 9435.442759338666
Min loss 0.006651323302793484
Max loss 82136.4609375
Avg_accepted loss 0.007310059001763787
Min_accepted loss 0.006651323302793484
Max_accepted loss 0.008224553762130112
Rejected 7


ITERATION: 6
Number of samples reused: 4
Mean: tensor([-2.3477, -2.4628, -1.8957, -2.3336, -1.9671, -0.3281, -1.8125, -0.2095,
        -1.3687, -1.5476, -0.5418, -0.8380], device='cuda:1')
Mean loss: 0.006740141879365826
MMD Mean loss: 0.006740141879365826
Avg loss 2461.375543625168
Min loss 0.0065831622463415045
Max loss 16775.07421875
Avg_accepted loss 0.007111437712446955
Min_accepted loss 0.0065831622463415045
Max_accepted loss 0.007786187777704972
Rejected 4


ITERATION: 7
Number of samples reused: 9
Mean: tensor([-2.4016, -2.4647, -1.9534, -2.3332, -1.9303, -0.2556, -1.7845, -0.2494,
        -1.3871, -1.5363, -0.5214, -0.8025], device='cuda:1')
Mean loss: 0.006906693270822641
MMD Mean loss: 0.006906693270822641
Avg loss 5208.492514023922
Min loss 0.0065831622463415045
Max loss 27578.0703125
Avg_accepted loss 0.007040380993427421
Min_accepted loss 0.0065831622463415045
Max_accepted loss 0.00745458671137718
Rejected 8


ITERATION: 8
Number of samples reused: 3
Mean: tensor([-2.4898, -2.5394, -1.9612, -2.3287, -1.9066, -0.1698, -1.7120, -0.2153,
        -1.4479, -1.4728, -0.4542, -0.8379], device='cuda:1')
Mean loss: 0.007512126382497598
MMD Mean loss: 0.007512126382497598
Avg loss 1560.1941908864464
Min loss 0.006491101103108868
Max loss 11360.8955078125
Avg_accepted loss 0.007139294450205287
Min_accepted loss 0.006491101103108868
Max_accepted loss 0.008315330262460625
Rejected 5


ITERATION: 9
Number of samples reused: 7
Mean: tensor([-2.4677, -2.6133, -2.0425, -2.3166, -1.9214, -0.2590, -1.6861, -0.3710,
        -1.3795, -1.4507, -0.4006, -0.8358], device='cuda:1')
Mean loss: 0.006942924969129213
MMD Mean loss: 0.006942924969129213
Avg loss 1084.0122786992567
Min loss 0.006491101103108868
Max loss 11316.931640625
Avg_accepted loss 0.0069585602019896055
Min_accepted loss 0.006491101103108868
Max_accepted loss 0.007791758987805592
Rejected 3


ITERATION: 10
Number of samples reused: 10
Mean: tensor([-2.5454, -2.6428, -2.0544, -2.3391, -1.9069, -0.2780, -1.6456, -0.3913,
        -1.3335, -1.4886, -0.4253, -0.8528], device='cuda:1')
Mean loss: 0.006640156537488395
MMD Mean loss: 0.006640156537488395
Avg loss 3264.9221324673604
Min loss 0.006516858950089827
Max loss 25448.796875
Avg_accepted loss 0.0070164668976379595
Min_accepted loss 0.006516858950089827
Max_accepted loss 0.007791758987805592
Rejected 5


ITERATION: 11
Number of samples reused: 4
Mean: tensor([-2.5434, -2.6386, -2.0694, -2.4120, -1.9403, -0.1833, -1.5169, -0.3984,
        -1.2644, -1.5083, -0.4287, -0.8363], device='cuda:1')
Mean loss: 0.006927828443103302
MMD Mean loss: 0.006927828443103302
Avg loss 1575.0132384201534
Min loss 0.006379783222855709
Max loss 37800.15625
Avg_accepted loss 0.0070205253775697
Min_accepted loss 0.006379783222855709
Max_accepted loss 0.007600199614038935
Rejected 1


ITERATION: 12
Number of samples reused: 10
Mean: tensor([-2.4077, -2.6659, -2.1311, -2.3085, -1.9434, -0.1825, -1.4564, -0.3471,
        -1.2655, -1.4986, -0.4481, -0.7860], device='cuda:1')
Mean loss: 0.006716390357710272
MMD Mean loss: 0.006716390357710272
Avg loss 0.0069347581086366995
Min loss 0.006379783222855709
Max loss 0.0075851450590911544
Avg_accepted loss 0.0069347581086366995
Min_accepted loss 0.006379783222855709
Max_accepted loss 0.0075851450590911544
Rejected 0


ITERATION: 13
Number of samples reused: 6
Mean: tensor([-2.3887, -2.7159, -2.1268, -2.3082, -1.9121, -0.1328, -1.4149, -0.2808,
        -1.3024, -1.4662, -0.4405, -0.7663], device='cuda:1')
Mean loss: 0.006647545969621209
MMD Mean loss: 0.006647545969621209
Avg loss 1299.2579391755794
Min loss 0.006482947176009149
Max loss 13053.7060546875
Avg_accepted loss 0.007079470551136646
Min_accepted loss 0.006482947176009149
Max_accepted loss 0.0077871204310570276
Rejected 5


ITERATION: 14
Number of samples reused: 6
Mean: tensor([-2.4067, -2.7436, -2.1242, -2.3249, -1.9127, -0.0467, -1.5048, -0.2285,
        -1.3277, -1.3699, -0.3989, -0.7448], device='cuda:1')
Mean loss: 0.006856355557582153
MMD Mean loss: 0.006856355557582153
Avg loss 1894.7269015263676
Min loss 0.006471633564686508
Max loss 16738.900390625
Avg_accepted loss 0.007104530216354182
Min_accepted loss 0.006471633564686508
Max_accepted loss 0.0077871204310570276
Rejected 5


ITERATION: 15
Number of samples reused: 6
Mean: tensor([-2.4518, -2.7909, -2.0394, -2.3688, -1.8318,  0.0229, -1.5316, -0.3110,
        -1.3572, -1.3226, -0.4236, -0.7000], device='cuda:1')
Mean loss: 0.007127728770223235
MMD Mean loss: 0.007127728770223235
Avg loss 665.0741216872561
Min loss 0.006355431602770451
Max loss 13327.23828125
Avg_accepted loss 0.00692980229090259
Min_accepted loss 0.006355431602770451
Max_accepted loss 0.0075249380860246025
Rejected 2


ITERATION: 16
Number of samples reused: 6
Mean: tensor([-2.4500, -2.8331, -2.0025, -2.3553, -1.8681,  0.0643, -1.5563, -0.3132,
        -1.3587, -1.2903, -0.4009, -0.6760], device='cuda:1')
Mean loss: 0.0072033434097975545
MMD Mean loss: 0.0072033434097975545
Avg loss 1581.4969207700515
Min loss 0.006332887954705889
Max loss 17867.017578125
Avg_accepted loss 0.0069756317697603765
Min_accepted loss 0.006332887954705889
Max_accepted loss 0.007976817401181757
Rejected 5


ITERATION: 17
Number of samples reused: 9
Mean: tensor([-2.4216, -2.8353, -2.0136, -2.3284, -1.9384,  0.0758, -1.5481, -0.3074,
        -1.3059, -1.2308, -0.3623, -0.6428], device='cuda:1')
Mean loss: 0.006956305522296076
MMD Mean loss: 0.006956305522296076
Avg loss 2081.1336188741825
Min loss 0.006332887954705889
Max loss 17867.017578125
Avg_accepted loss 0.006961667313276533
Min_accepted loss 0.006332887954705889
Max_accepted loss 0.007533212304483931
Rejected 3


ITERATION: 18
Number of samples reused: 5
Mean: tensor([-2.3704, -2.8733, -2.0069, -2.3354, -1.9602,  0.0315, -1.5578, -0.3335,
        -1.2924, -1.2229, -0.3914, -0.6337], device='cuda:1')
Mean loss: 0.006245798207292525
MMD Mean loss: 0.006245798207292525
Avg loss 1449.44600684829
Min loss 0.006427806586159055
Max loss 14559.751953125
Avg_accepted loss 0.006973354667157468
Min_accepted loss 0.006427806586159055
Max_accepted loss 0.007911645756356637
Rejected 2


ITERATION: 19
Number of samples reused: 4
Mean: tensor([-2.3918, -2.9438, -2.0050, -2.3285, -1.9301,  0.0115, -1.5504, -0.3451,
        -1.3007, -1.2238, -0.3454, -0.6991], device='cuda:1')
Mean loss: 0.0071537952751079305
MMD Mean loss: 0.0071537952751079305
Avg loss 300.51234895623156
Min loss 0.0064108652373493545
Max loss 7212.13818359375
Avg_accepted loss 0.006877885035148289
Min_accepted loss 0.0064108652373493545
Max_accepted loss 0.007420153248898227
Rejected 1


ITERATION: 20
Number of samples reused: 9
Mean: tensor([-2.4121, -2.9147, -2.0281, -2.2940, -1.9044,  0.0298, -1.5558, -0.3507,
        -1.3322, -1.1777, -0.3923, -0.6987], device='cuda:1')
Mean loss: 0.006855719670824249
MMD Mean loss: 0.006855719670824249
Avg loss 0.0069456013716248455
Min loss 0.0064108652373493545
Max loss 0.007420153248898227
Avg_accepted loss 0.0069456013716248455
Min_accepted loss 0.0064108652373493545
Max_accepted loss 0.007420153248898227
Rejected 0


ITERATION: 21
Number of samples reused: 6
Mean: tensor([-2.3994, -2.9409, -2.0208, -2.3058, -1.8903,  0.0497, -1.5436, -0.3743,
        -1.3212, -1.1284, -0.3937, -0.6799], device='cuda:1')
Mean loss: 0.0070701290104493615
MMD Mean loss: 0.0070701290104493615
Avg loss 301.45686290066686
Min loss 0.006559853525669516
Max loss 6048.04736328125
Avg_accepted loss 0.006957459463316381
Min_accepted loss 0.006559853525669516
Max_accepted loss 0.007384872094145216
Rejected 2


ITERATION: 22
Number of samples reused: 8
Mean: tensor([-2.4156, -2.9440, -2.0698, -2.2940, -1.8911,  0.0957, -1.5813, -0.3991,
        -1.3066, -1.1158, -0.4266, -0.6516], device='cuda:1')
Mean loss: 0.006930096680378287
MMD Mean loss: 0.006930096680378287
Avg loss 252.0085637115103
Min loss 0.006492517311057267
Max loss 6048.04736328125
Avg_accepted loss 0.0068767736955607905
Min_accepted loss 0.006492517311057267
Max_accepted loss 0.007565606376135089
Rejected 0


ITERATION: 23
Number of samples reused: 4
Mean: tensor([-2.4395, -2.9163, -2.1196, -2.2674, -1.8930,  0.0998, -1.5786, -0.3776,
        -1.2989, -1.1110, -0.4049, -0.6630], device='cuda:1')
Mean loss: 0.006807274881603787
MMD Mean loss: 0.006807274881603787
Avg loss 0.00691392769055084
Min loss 0.006318287842834835
Max loss 0.00770558830445473
Avg_accepted loss 0.00691392769055084
Min_accepted loss 0.006318287842834835
Max_accepted loss 0.00770558830445473
Rejected 0




Early stopping 0.006920654698555516

---------------------------------------------------


Final loss and MMD loss:
tensor(0.0069, device='cuda:1', dtype=torch.float64)
tensor(0.0069, dtype=torch.float64)
Final mean:
tensor([-2.4491, -2.8862, -2.1734, -2.2820, -1.8708,  0.0586, -1.5814, -0.3531,
        -1.3000, -1.0911, -0.3812, -0.6488], device='cuda:1')

Final covariance matrix:
tensor([[0.0062, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0062, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0062, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0062, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0062, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0062, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0062, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0062, 0.0000,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0062,
         0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0062, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0062, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0062]], device='cuda:1')

time taken: 3812.006454706192
number of iterations: 24
average time per iter: 158.83360227942467
