#### Mouse V1 Project log file ####

Code ran on the 2024-05-17 13:02:59.765841

Device: cuda:1
OS: linux
Machine: cblgpu07
Trainer type: xNES

NES with JSD

Metadata:
Number of neurons: 1000
Number of feedforward neurons: 100
Number of Euler steps: 300
Record average step after 280 steps
Average step weighting: 0.1
Valid weight weighting: 100000.0

Max_number of xNES optimisation step: 200
Min_number of xNES optimisation step: 20
Stopping criterion step condition for xNES optimisation: 1e-07
Stopping criterion step tolerance: 2
Number of samples per optimisation step: 24
Number of trials per full simulation: 1
Alpha for important mixing: 0.10000000149011612
Learning Rates: eta_delta=1, eta_sigma=0.08, eta_B=0.08
adaptive_lr: False
beta: 0.20000000298023224
---------------------------------------------------

Initial parameters
J
tensor([-3.0533,  1.1718,  3.4926, -2.4472], device='cuda:1')
P
tensor([ 4.3556, -2.4782, -4.1099,  4.3962], device='cuda:1')
w
tensor([ 2.2513,  3.8679, -1.8616, -0.8437], device='cuda:1')
heter_ff
tensor(0.2000, device='cuda:1')

Covariance Matrix
tensor([[0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.5000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.5000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.5000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.5000]], device='cuda:1')

---------------------------------------------------


ITERATION: 0
Number of samples reused: 0
Mean: tensor([-3.0533,  1.1718,  3.4926, -2.4472,  4.3556, -2.4782, -4.1099,  4.3962,
         2.2513,  3.8679, -1.8616, -0.8437,  0.2000], device='cuda:1')
Mean loss: 0.12461394816637039
MMD Mean loss: 0.12461394816637039
Avg loss 1809425.0
Min loss 71926.140625
Max loss 11781349.0
Avg_accepted loss 0.0
Min_accepted loss 0.0
Max_accepted loss 0.0
Rejected 24


ITERATION: 1
Number of samples reused: 6
Mean: tensor([-3.5750,  1.1121,  3.5779, -2.2001,  3.8652, -2.3830, -3.5919,  4.3483,
         2.2720,  3.7360, -1.4098, -0.6654, -0.0707], device='cuda:1')
Mean loss: 0.026236843317747116
MMD Mean loss: 0.026236843317747116
Avg loss 345283.375
Min loss 7733.02294921875
Max loss 1735782.0
Avg_accepted loss 0.0
Min_accepted loss 0.0
Max_accepted loss 0.0
Rejected 18


ITERATION: 2
Number of samples reused: 7
Mean: tensor([-4.2670,  0.4891,  3.5836, -2.0211,  3.9968, -2.1722, -3.3989,  4.3544,
         2.5539,  3.5822, -1.3080, -0.5382,  0.2532], device='cuda:1')
Mean loss: 0.029070448130369186
MMD Mean loss: 0.029070448130369186
Avg loss 185556.875
Min loss 0.03836710751056671
Max loss 628076.4375
Avg_accepted loss 0.03836710751056671
Min_accepted loss 0.03836710751056671
Max_accepted loss 0.03836710751056671
Rejected 16


ITERATION: 3
Number of samples reused: 5
Mean: tensor([-4.9933,  0.0191,  3.6681, -2.1744,  4.1063, -1.8348, -3.2917,  4.3095,
         2.3887,  3.2724, -1.1305, -0.3427, -0.1417], device='cuda:1')
Mean loss: 0.034166526049375534
MMD Mean loss: 0.034166526049375534
Avg loss 66534.25
Min loss 0.019307326525449753
Max loss 267792.96875
Avg_accepted loss 0.025957895442843437
Min_accepted loss 0.019307326525449753
Max_accepted loss 0.03836710751056671
Rejected 13


ITERATION: 4
Number of samples reused: 7
Mean: tensor([-5.2152, -0.3410,  3.5310, -2.1150,  4.3892, -2.1279, -2.8454,  3.9667,
         2.2135,  3.3404, -1.0252, -0.0132, -0.0368], device='cuda:1')
Mean loss: 0.02575237676501274
MMD Mean loss: 0.02575237676501274
Avg loss 12936.1279296875
Min loss 0.016505669802427292
Max loss 118610.0
Avg_accepted loss 0.03017273172736168
Min_accepted loss 0.016505669802427292
Max_accepted loss 0.05878240987658501
Rejected 7


ITERATION: 5
Number of samples reused: 0
Mean: tensor([-5.2857, -0.6740,  3.5123, -2.1564,  4.3588, -2.1727, -2.6667,  4.0171,
         2.0079,  3.4407, -0.9519,  0.1802,  0.2544], device='cuda:1')
Mean loss: 0.017678093165159225
MMD Mean loss: 0.017678093165159225
Avg loss 9509.458984375
Min loss 0.01334841176867485
Max loss 96769.0234375
Avg_accepted loss 0.03140736371278763
Min_accepted loss 0.01334841176867485
Max_accepted loss 0.10925014317035675
Rejected 10


ITERATION: 6
Number of samples reused: 8
Mean: tensor([-5.4929, -0.7568,  3.5573, -2.1249,  4.0031, -2.3645, -2.5358,  3.5176,
         1.9893,  3.4207, -0.7808, -0.0553,  0.0476], device='cuda:1')
Mean loss: 0.017756056040525436
MMD Mean loss: 0.017756056040525436
Avg loss 6320.1591796875
Min loss 0.01334841176867485
Max loss 73381.28125
Avg_accepted loss 0.047812603414058685
Min_accepted loss 0.01334841176867485
Max_accepted loss 0.15608055889606476
Rejected 5


ITERATION: 7
Number of samples reused: 2
Mean: tensor([-5.5190, -1.0105,  3.1265, -2.2682,  3.8330, -2.4052, -2.6145,  3.2079,
         1.8516,  3.3022, -0.6306, -0.0384, -0.0720], device='cuda:1')
Mean loss: 0.01588590070605278
MMD Mean loss: 0.01588590070605278
Avg loss 3313.1015625
Min loss 0.013713192194700241
Max loss 44991.7421875
Avg_accepted loss 0.024705994874238968
Min_accepted loss 0.013713192194700241
Max_accepted loss 0.08679515868425369
Rejected 3


ITERATION: 8
Number of samples reused: 5
Mean: tensor([-5.4594, -1.1917,  3.1616, -2.2311,  3.8863, -2.6811, -2.6794,  3.2215,
         1.5810,  3.1283, -0.5794, -0.0691, -0.0723], device='cuda:1')
Mean loss: 0.015078019350767136
MMD Mean loss: 0.015078019350767136
Avg loss 1634.3431396484375
Min loss 0.013093899935483932
Max loss 30045.32421875
Avg_accepted loss 0.018749387934803963
Min_accepted loss 0.013093899935483932
Max_accepted loss 0.045362427830696106
Rejected 3


ITERATION: 9
Number of samples reused: 5
Mean: tensor([-5.5966, -1.3565,  3.1504, -2.3008,  3.6686, -2.7402, -2.5832,  3.1897,
         1.5381,  2.9774, -0.7450,  0.1341, -0.1345], device='cuda:1')
Mean loss: 0.013784121721982956
MMD Mean loss: 0.013784121721982956
Avg loss 738.0980834960938
Min loss 0.012900423258543015
Max loss 13173.8740234375
Avg_accepted loss 0.017522089183330536
Min_accepted loss 0.012900423258543015
Max_accepted loss 0.03320164605975151
Rejected 3


ITERATION: 10
Number of samples reused: 7
Mean: tensor([-5.5680, -1.2087,  3.0835, -2.3582,  3.5591, -2.7506, -2.5867,  3.0627,
         1.4818,  2.8672, -0.9076,  0.3506,  0.0257], device='cuda:1')
Mean loss: 0.014420103281736374
MMD Mean loss: 0.014420103281736374
Avg loss 562.5277099609375
Min loss 0.012900423258543015
Max loss 7177.7998046875
Avg_accepted loss 0.017968682572245598
Min_accepted loss 0.012900423258543015
Max_accepted loss 0.033538173884153366
Rejected 2


ITERATION: 11
Number of samples reused: 4
Mean: tensor([-5.4348, -1.1607,  3.0626, -2.4665,  3.4300, -2.7849, -2.6427,  2.9898,
         1.5261,  2.9034, -0.9519,  0.4555,  0.0951], device='cuda:1')
Mean loss: 0.013985704630613327
MMD Mean loss: 0.013985704630613327
Avg loss 353.71405029296875
Min loss 0.013078521937131882
Max loss 8488.6845703125
Avg_accepted loss 0.019653091207146645
Min_accepted loss 0.013078521937131882
Max_accepted loss 0.08431846648454666
Rejected 1


ITERATION: 12
Number of samples reused: 4
Mean: tensor([-5.4336, -1.2390,  3.1895, -2.4041,  3.4896, -2.9252, -2.7283,  2.8559,
         1.5439,  2.9122, -0.6534,  0.4547,  0.1855], device='cuda:1')
Mean loss: 0.013149451464414597
MMD Mean loss: 0.013149451464414597
Avg loss 580.35498046875
Min loss 0.01274402067065239
Max loss 8758.294921875
Avg_accepted loss 0.017718413844704628
Min_accepted loss 0.01274402067065239
Max_accepted loss 0.03481752797961235
Rejected 2


ITERATION: 13
Number of samples reused: 11
Mean: tensor([-5.5434, -1.3661,  3.2333, -2.4503,  3.4386, -3.2211, -2.8247,  2.8805,
         1.5390,  2.7843, -0.6632,  0.4991,  0.3171], device='cuda:1')
Mean loss: 0.012778829783201218
MMD Mean loss: 0.012778829783201218
Avg loss 1525.5643310546875
Min loss 0.01274402067065239
Max loss 9679.662109375
Avg_accepted loss 0.021337859332561493
Min_accepted loss 0.01274402067065239
Max_accepted loss 0.0624198392033577
Rejected 5


ITERATION: 14
Number of samples reused: 5
Mean: tensor([-5.7091, -1.3654,  3.2558, -2.4773,  3.3849, -3.2394, -2.7961,  2.7910,
         1.5713,  2.6752, -0.7346,  0.4789,  0.1870], device='cuda:1')
Mean loss: 0.013318967074155807
MMD Mean loss: 0.013318967074155807
Avg loss 1187.133056640625
Min loss 0.012940477579832077
Max loss 9679.662109375
Avg_accepted loss 0.019910141825675964
Min_accepted loss 0.012940477579832077
Max_accepted loss 0.05571432411670685
Rejected 3


ITERATION: 15
Number of samples reused: 8
Mean: tensor([-5.8443, -1.3073,  3.1630, -2.5235,  3.3535, -3.2162, -2.8452,  2.6291,
         1.4905,  2.5231, -0.5606,  0.5008,  0.1109], device='cuda:1')
Mean loss: 0.013509344309568405
MMD Mean loss: 0.013509344309568405
Avg loss 6.806804656982422
Min loss 0.012940477579832077
Max loss 162.9836883544922
Avg_accepted loss 0.01650569587945938
Min_accepted loss 0.012940477579832077
Max_accepted loss 0.03790111467242241
Rejected 1


ITERATION: 16
Number of samples reused: 9
Mean: tensor([-5.9363, -1.3724,  3.1546, -2.6571,  3.2360, -3.3146, -2.8708,  2.6493,
         1.4785,  2.4135, -0.4667,  0.4762,  0.0989], device='cuda:1')
Mean loss: 0.013375591486692429
MMD Mean loss: 0.013375591486692429
Avg loss 129.6907958984375
Min loss 0.01281590387225151
Max loss 3112.188720703125
Avg_accepted loss 0.01697169616818428
Min_accepted loss 0.01281590387225151
Max_accepted loss 0.049781035631895065
Rejected 1


ITERATION: 17
Number of samples reused: 4
Mean: tensor([-5.9661, -1.2765,  3.0956, -2.7432,  3.2408, -3.4584, -2.8975,  2.7642,
         1.5312,  2.4323, -0.4001,  0.3304,  0.1676], device='cuda:1')
Mean loss: 0.013054680079221725
MMD Mean loss: 0.013054680079221725
Avg loss 617.5155639648438
Min loss 0.01281590387225151
Max loss 10550.0634765625
Avg_accepted loss 0.015513826161623001
Min_accepted loss 0.01281590387225151
Max_accepted loss 0.02739400789141655
Rejected 3


ITERATION: 18
Number of samples reused: 2
Mean: tensor([-5.9782, -1.2736,  3.1470, -2.8203,  3.1913, -3.5108, -2.8847,  2.8000,
         1.5021,  2.4870, -0.4943,  0.2925,  0.2298], device='cuda:1')
Mean loss: 0.013201545923948288
MMD Mean loss: 0.013201545923948288
Avg loss 0.016557913273572922
Min loss 0.012746762484312057
Max loss 0.0468103401362896
Avg_accepted loss 0.016557913273572922
Min_accepted loss 0.012746762484312057
Max_accepted loss 0.0468103401362896
Rejected 0


ITERATION: 19
Number of samples reused: 7
Mean: tensor([-5.9862, -1.1581,  3.1266, -2.7439,  3.2179, -3.5620, -2.9426,  2.7986,
         1.5312,  2.5059, -0.6387,  0.2783,  0.1461], device='cuda:1')
Mean loss: 0.013570498675107956
MMD Mean loss: 0.013570498675107956
Avg loss 86.33281707763672
Min loss 0.012746762484312057
Max loss 2071.64208984375
Avg_accepted loss 0.015015050768852234
Min_accepted loss 0.012746762484312057
Max_accepted loss 0.019253205507993698
Rejected 1


ITERATION: 20
Number of samples reused: 7
Mean: tensor([-5.9304, -1.1131,  3.0248, -2.6733,  3.2224, -3.6925, -2.9349,  2.7854,
         1.6203,  2.6085, -0.6661,  0.3039,  0.1390], device='cuda:1')
Mean loss: 0.013142775744199753
MMD Mean loss: 0.013142775744199753
Avg loss 752.2311401367188
Min loss 0.01281578466296196
Max loss 8244.2548828125
Avg_accepted loss 0.014967599883675575
Min_accepted loss 0.01281578466296196
Max_accepted loss 0.019610833376646042
Rejected 5


ITERATION: 21
Number of samples reused: 4
Mean: tensor([-5.9309, -1.1230,  2.9958, -2.6209,  3.2320, -3.7027, -2.7904,  2.6674,
         1.6144,  2.6008, -0.5933,  0.3820,  0.1067], device='cuda:1')
Mean loss: 0.013223003596067429
MMD Mean loss: 0.013223003596067429
Avg loss 156.77752685546875
Min loss 0.012796830385923386
Max loss 3477.917236328125
Avg_accepted loss 0.014024128206074238
Min_accepted loss 0.012796830385923386
Max_accepted loss 0.02028055116534233
Rejected 2


ITERATION: 22
Number of samples reused: 10
Mean: tensor([-5.9487, -1.0837,  2.9948, -2.6392,  3.3358, -3.7129, -2.8128,  2.6514,
         1.6668,  2.5455, -0.5803,  0.4088,  0.0582], device='cuda:1')
Mean loss: 0.01339859887957573
MMD Mean loss: 0.01339859887957573
Avg loss 214.39891052246094
Min loss 0.012796830385923386
Max loss 3477.917236328125
Avg_accepted loss 0.014963464811444283
Min_accepted loss 0.012796830385923386
Max_accepted loss 0.024323176592588425
Rejected 1


ITERATION: 23
Number of samples reused: 3
Mean: tensor([-5.9896e+00, -1.0421e+00,  2.9978e+00, -2.6830e+00,  3.3561e+00,
        -3.6664e+00, -2.8803e+00,  2.6082e+00,  1.6423e+00,  2.4961e+00,
        -5.5844e-01,  4.2967e-01,  3.7777e-03], device='cuda:1')
Mean loss: 0.01356954500079155
MMD Mean loss: 0.01356954500079155
Avg loss 0.014316391199827194
Min loss 0.012921284884214401
Max loss 0.017637204378843307
Avg_accepted loss 0.014316391199827194
Min_accepted loss 0.012921284884214401
Max_accepted loss 0.017637204378843307
Rejected 0


ITERATION: 24
Number of samples reused: 7
Mean: tensor([-5.9691, -0.9287,  2.9133, -2.6401,  3.3848, -3.7832, -2.8686,  2.6091,
         1.6812,  2.5667, -0.5820,  0.4189, -0.0338], device='cuda:1')
Mean loss: 0.013625096529722214
MMD Mean loss: 0.013625096529722214
Avg loss 0.01434833463281393
Min loss 0.012771796435117722
Max loss 0.018899034708738327
Avg_accepted loss 0.01434833463281393
Min_accepted loss 0.012771796435117722
Max_accepted loss 0.018899034708738327
Rejected 0




Early stopping 0.013367068953812122

---------------------------------------------------


Final loss and MMD loss:
tensor(0.0131, device='cuda:1')
tensor(0.0131, device='cuda:1')
Final mean:
tensor([-5.9117, -0.9944,  2.9481, -2.6563,  3.4741, -3.7748, -2.8376,  2.6013,
         1.7727,  2.6170, -0.6375,  0.3875, -0.1293], device='cuda:1')

Final covariance matrix:
tensor([[0.0316, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0316, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0316, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0316, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0316, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0316, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0316, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0316, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0316,
         0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0316, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0316, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0316, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0316]], device='cuda:1')

time taken: 1073.3227880001068
number of iterations: 25
average time per iter: 42.932911520004275
